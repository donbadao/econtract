"use strict";(self["webpackChunkecontract_frontend"]=self["webpackChunkecontract_frontend"]||[]).push([[203],{2847:function(t,s,a){a.d(s,{Z:function(){return l}});var e=function(){var t=this,s=t._self._c;return s("div",{staticClass:"col flex-column text-center"},[s("svg",{attrs:{width:"100",height:"100"}},[s("svg",{attrs:{id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 208 230"}},[s("defs",[s("linearGradient",{attrs:{id:"colorNodata",x1:"133.69",y1:"120.61",x2:"73.06",y2:"91.22",gradientTransform:"matrix(1, 0, 0, -1, 0, 231.28)",gradientUnits:"userSpaceOnUse"}},[s("stop",{attrs:{offset:"0","stop-color":"#95abc2"}}),s("stop",{attrs:{offset:"1","stop-color":"#fff"}})],1),s("mask",{attrs:{id:"maskColorNodata",x:"134.5",y:"14.55",width:"17.97",height:"17.21",maskUnits:"userSpaceOnUse"}},[s("g",{attrs:{id:"handFlag"}},[s("path",{attrs:{d:"M137,24a8.1,8.1,0,0,1,8.1-8.1h6.3v6.3a8.1,8.1,0,0,1-8.1,8.1H137Z",fill:"#fff"}})])])],1),s("path",{attrs:{d:"M94.2,85.7l85.9,23.6v82.6l-85.9-37Z",fill:"#8e99a3"}}),s("path",{attrs:{d:"M94.3,85.7,24.1,105.3v86.8l70.1-37.6Z",fill:"#a0aab5"}}),s("path",{attrs:{d:"M139.4,185.9c-19.4-5.7-53.4-5.2-66.2-38.3-11.7-30.4,31.5-59.6,43.6-46.8,8.6,9.1-2.4,22.2-17.7,20.7C82,119.8,71.9,104.5,75.3,88c6.7-32.7,58.3-54.4,60.5-55.9",fill:"none","stroke-width":"3","stroke-dasharray":"6 7",stroke:"url(#colorNodata)"}}),s("path",{attrs:{d:"M141,21.5s-.5-12.3-3.7-15.6a8.4,8.4,0,0,0-11.8,11.8C128.7,21,141,21.5,141,21.5Z",fill:"#ced8e5",opacity:"0.4"}}),s("path",{attrs:{d:"M146.7,26.4s.5,12.3,3.7,15.6a8.4,8.4,0,0,0,11.8-11.8C159.1,26.9,146.7,26.4,146.7,26.4Z",fill:"#ced8e5",opacity:"0.4"}}),s("path",{attrs:{d:"M137,24a8.1,8.1,0,0,1,8.1-8.1h6.3v6.3a8.1,8.1,0,0,1-8.1,8.1H137Z",fill:"#a8b7c5"}}),s("g",{attrs:{mask:"url(#maskColorNodata)"}},[s("rect",{attrs:{x:"140.1",y:"16.7",width:"2.3",height:"16.69",transform:"translate(23.6 107.2) rotate(-45)",fill:"#dde5f2"}}),s("path",{attrs:{d:"M139.1,16.2l1.6-1.6,11.8,11.8L150.9,28Z",fill:"#dde5f2"}})]),s("path",{attrs:{d:"M159.2,12.3l5.5-1.3",fill:"none",stroke:"#8696c5","stroke-width":"0.9"}}),s("path",{attrs:{d:"M156.9,10.1l2.1-5.5",fill:"none",stroke:"#8696c5","stroke-width":"0.9"}}),s("path",{attrs:{d:"M153.7,20.5a6.1,6.1,0,1,0-6.1-6.1A6.1,6.1,0,0,0,153.7,20.5Z",fill:"#8b9aa8"}}),s("path",{attrs:{d:"M24.1,105.5,110,132.8V229L24.1,192Z",fill:"#dae2ec"}}),s("path",{attrs:{d:"M180.5,109.2l-71.7,23.6V229l71.7-37Z",fill:"#c5d0d9"}}),s("path",{attrs:{d:"M180.3,109.1,208,146.2l-73.6,29L109,132.6Z",fill:"#dae2ec"}}),s("path",{attrs:{d:"M24,105.3,0,142.8l84.6,32.4,24.7-42.7Z",fill:"#c5d0d9"}})])]),s("h4",{staticClass:"text-center font-size-20px mb-2 text-no--data text-primary"},[t._v("Chưa có dữ liệu")]),s("div",{staticClass:"text-muted"},[t._v("Hãy thêm dữ liệu hoặc Kiểm tra lại thông tin tra cứu")])])},i=[],n=a(1001),o={},r=(0,n.Z)(o,e,i,!1,null,null,null),l=r.exports},1203:function(t,s,a){a.r(s),a.d(s,{default:function(){return A}});var e=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"commissions-list"}},[s("h1",{staticClass:"fw-bold title-page"},[t._v("Danh sách thanh toán hoa hồng")]),s("div",{staticClass:"card mb-2"},[s("div",{staticClass:"card-body"},[s("div",{staticClass:"row gy-4 gy-sm-1"},[s("div",{staticClass:"col-sm-6 col-lg-3"},[s("div",{staticClass:"d-flex justify-content-between align-items-start card-widget-1 border-end pb-3 pb-sm-0"},[s("div",[s("h3",{staticClass:"mb-1 block fw-bold text-danger"},[t._v(" "+t._s(t._f("formatamout")(t.totalComission))+"đ ")]),s("p",{staticClass:"mb-0"},[t._v("Tổng số tiền thanh toán")])]),t._m(0)])]),s("div",{staticClass:"col-sm-6 col-lg-3"},[s("div",{staticClass:"d-flex justify-content-between align-items-start card-widget-1 border-end pb-3 pb-sm-0"},[s("div",[s("h3",{staticClass:"mb-1 block fw-bold text-danger"},[t._v(t._s(t.totalVerb))]),s("p",{staticClass:"mb-0"},[t._v("Số phiếu thanh toán")])]),t._m(1)])])])])]),s("div",{staticClass:"row gy-2 gx-3 align-items-center mb-2"},[s("div",{staticClass:"col-sm-5"},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nhập mã số thuế hoặc tên doanh nghiệp để tìm kiếm...."},domProps:{value:t.keyword},on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.openModalSearch()},input:function(s){s.target.composing||(t.keyword=s.target.value)}}})])]),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"form-group"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.partner_id,expression:"filter.partner_id"}],staticClass:"form-select",on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.$set(t.filter,"partner_id",s.target.multiple?a:a[0])}}},[s("option",{attrs:{value:"0"}},[t._v("Tất cả")]),t._l(t.partners,(function(a){return s("option",{key:a.partner_id,domProps:{value:a.partner_id}},[t._v(" "+t._s(a.partner_name)+" ")])}))],2)])]),s("div",{staticClass:"col-auto"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.comis_status,expression:"filter.comis_status"}],staticClass:"form-select",on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.$set(t.filter,"comis_status",s.target.multiple?a:a[0])}}},[s("option",{attrs:{value:"0"}},[t._v("Tất cả")]),s("option",{attrs:{value:"1"}},[t._v("Mới tạo lập")]),s("option",{attrs:{value:"2"}},[t._v("Trình ký")]),s("option",{attrs:{value:"3"}},[t._v("Đã nhận được tiền")])])]),s("div",{staticClass:"col-auto"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.currentMonth,expression:"filter.currentMonth"}],staticClass:"form-select",on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.$set(t.filter,"currentMonth",s.target.multiple?a:a[0])}}},t._l(t.months,(function(a){return s("option",{key:a},[t._v(t._s(a))])})),0)]),s("div",{staticClass:"col-auto"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.filter.currentYear,expression:"filter.currentYear"}],staticClass:"form-select",on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.$set(t.filter,"currentYear",s.target.multiple?a:a[0])}}},t._l(t.years,(function(a){return s("option",{key:a},[t._v(t._s(a))])})),0)]),s("div",[s("button",{staticClass:"btn btn-primary-soft me-2",attrs:{type:"button",id:"button-addon2"},on:{click:function(s){return t.search()}}},[s("i",{staticClass:"fa-solid fa-magnifying-glass"}),t._v(" Tìm kiếm ")]),s("router-link",{staticClass:"btn btn-primary",attrs:{to:{name:"commission-create"}}},[s("i",{staticClass:"fa-duotone fa-circle-plus"}),t._v(" Lập phiếu ")])],1)]),s("listCommissions",{attrs:{commissions:t.filterComissions},on:{showModalComplete:t.showModalComplete}}),0==t.filterComissions.length?s("not-found"):t._e(),s("ModalCompleteCommisson",{ref:"modalCompleteCommisson",on:{updateCommission:t.updateCommission}}),s("modal-search-turn",{ref:"modalSearchTurn"})],1)},i=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"avatar me-sm-4"},[s("div",{staticClass:"avatar-initial rounded bg-label-secondary"},[s("i",{staticClass:"fa-sharp fa-solid fa-dollar-sign"})])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"avatar me-sm-4"},[s("div",{staticClass:"avatar-initial rounded bg-label-secondary"},[s("i",{staticClass:"fa-sharp fa-solid fa-dollar-sign"})])])}],n=a(1859),o=function(){var t=this,s=t._self._c;return s("table",{staticClass:"table table-hover align-middle"},[t._m(0),s("tbody",[t._l(t.commissions,(function(a,e){return[s("tr",{key:e},[s("td",[s("button",{staticClass:"btn btn-default btn-xs",attrs:{"data-bs-toggle":"collapse",href:"#expand"+a.tunr_id,title:"Xem chi tiết dịch vụ"}},[s("i",{staticClass:"fa-regular fa-circle-plus"})])]),s("td",[s("strong",{staticClass:"text-primary"},[t._v(t._s(a.turn_name))])]),s("td",{staticClass:"text-center"},[t._v(t._s(t._f("moment")(a.turn_date,"DD/MM/YYYY")))]),s("td",{staticClass:"text-center"},[s("strong",{staticClass:"text-primary"},[t._v(t._s(t.getStatus(a.turn_status)))])]),s("td"),s("td"),s("td",[s("div",{staticClass:"dropdown"},[t._m(1,!0),s("ul",{staticClass:"dropdown-menu"},[s("li",[s("span",{staticClass:"hand dropdown-item",on:{click:function(s){return t.showModalComplete(a,e)}}},[s("i",{staticClass:"fa-thin fa-circle-check"}),t._v(" Hoàn thiện ")])])])])])]),t._l(a.comissions,(function(a,e){return s("tr",{key:a.detail_id},[s("td"),s("td",[s("ul",{staticClass:"list-group"},[s("li",{staticClass:"list-group-item bg-success bg-opacity-10"},[s("strong",[t._v(t._s(a.partner.partner_name))])]),t._l(a.details,(function(a){return s("li",{key:a.detail_id,staticClass:"list-group-item"},[s("router-link",{staticClass:"text-dark fw-normal",attrs:{tag:"a",title:a.company_name,to:{name:"commission-edit",params:{id:a.comis_id}}}},[t._v(" "+t._s(a.company_name)+" ")])],1)}))],2)]),s("td",{staticClass:"text-center"},[s("ul",{staticClass:"list-group"},[t._m(2,!0),t._l(a.details,(function(a){return s("li",{key:a.company_name+a.comis_id,staticClass:"list-group-item"},[s("a",{staticClass:"text-danger"},[t._v(t._s(t.formatAmout(a.comis_price))+"₫")])])}))],2)]),s("td",{staticClass:"text-center"},[t._v(" "+t._s(t.getStatus(a.comis_status))+" ")]),s("td",[s("strong",{staticClass:"text-danger"},[t._v(" "+t._s(t.formatAmout(a.comis_total))+"đ ")])]),s("td",[s("button",{staticClass:"btn btn-primary btn-sm me-2",attrs:{title:"Tải về file Đề nghị thu mua"},on:{click:function(s){return t.downloadFile(a,2)}}},[s("i",{staticClass:"fa-solid fa-file-word"})]),s("button",{staticClass:"btn btn-primary btn-sm me-2",attrs:{title:"Tải về file đề nghị thanh toán"},on:{click:function(s){return t.downloadFile(a,1)}}},[s("i",{staticClass:"fa-solid fa-file-word"})]),s("button",{staticClass:"btn btn-success btn-sm",attrs:{title:"Tải về file Bảng kê tổng hợp"},on:{click:function(s){return t.downloadFile(a,0)}}},[s("i",{staticClass:"fa-solid fa-file-excel"})])]),s("td",[s("div",{staticClass:"dropdown"},[t._m(3,!0),s("ul",{staticClass:"dropdown-menu"},[s("li",[s("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"commission-edit",params:{id:a.comis_id}}}},[s("i",{staticClass:"fa-thin fa-pen-to-square"}),t._v(" Cập nhật phiếu ")])],1),s("li",[s("a",{staticClass:"dropdown-item hand",on:{click:function(s){return t.updatePayment(a)}}},[s("i",{staticClass:"fa-thin fa-circle-dollar"}),t._v(" Đã nhận được tiền")])]),s("li",[s("a",{staticClass:"dropdown-item hand text-danger fw-bold",on:{click:function(s){return t.destroy(a,e)}}},[s("i",{staticClass:"fa-thin fa-trash-can"}),t._v(" Hủy phiếu")])])])])])])}))]}))],2)])},r=[function(){var t=this,s=t._self._c;return s("thead",{staticClass:"table-dark"},[s("tr",[s("th",{staticClass:"rounded-start",attrs:{width:"10"}},[t._v("#")]),s("th",{attrs:{width:"40%"}},[t._v("Tên đợt thanh toán")]),s("th",{staticClass:"text-center"},[t._v("Ngày lập")]),s("th",{staticClass:"text-center"},[t._v("Trạng thái")]),s("th",[t._v("Tổng tiền")]),s("th"),s("th",{staticClass:"rounded-end"})])])},function(){var t=this,s=t._self._c;return s("button",{staticClass:"btn border-0 btn-sm btn-round",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[s("i",{staticClass:"fa-solid fa-ellipsis-vertical"})])},function(){var t=this,s=t._self._c;return s("li",{staticClass:"list-group-item bg-light"},[s("strong",[t._v("Chi tiết")])])},function(){var t=this,s=t._self._c;return s("button",{staticClass:"btn border-0 btn-sm btn-round",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[s("i",{staticClass:"fa-solid fa-ellipsis-vertical"})])}],l=(a(8858),a(1318),a(3228),{props:{commissions:Array},data(){return{types:[{type:0,name:"Bang-Tong-Hop.xlsx"},{type:1,name:"De-Nghi-Thanh-Toan.docx"},{type:2,name:"De-Nghi-Thu-Mua.docx"}]}},methods:{showModalComplete(t,s){this.$emit("showModalComplete",t,s)},async updatePayment(t){this.$confirm({title:"Cập phiếu thanh toán",message:"Bạn có thanh toán phiếu này không?",button:{yes:"Yes",no:"No"},callback:s=>{if(s){let s=this;n.Z.put(`${API_URL}/commissions/update`,{comis_id:t.comis_id,comis_status:2}).then((a=>{if(200==a.status){let a=s.commissions.filter((s=>s.turn_id==t.turn_id))[0].comissions;a.filter((s=>s.comis_id==t.comis_id))[0].comis_status=2,this.$toast.success("Cập nhật phiếu thanh toán thành công")}}))}}})},async destroy(t,s){let a=this;this.$confirm({title:"Hủy phiếu thanh toán",message:"Bạn có muốn phiếu này không?",button:{yes:"Yes",no:"No"},callback:s=>{s&&n.Z.delete(`${API_URL}/commissions/${t.comis_id}`).then((s=>{200==s.data&&(a.commissions=a.commissions.map((s=>(s.comissions=s.comissions.filter((s=>s.comis_id!==t.comis_id)),s))),a.$toast.success("Xóa phiếu thành công"))}))}})},async downloadFile(t,s){this.$econtract.showLoading(),await n.Z.post(`${API_URL}/commissions/export`,{comis_id:t.comis_id,type:s},{responseType:"blob"}).then((a=>{let e=`${t.partner.partner_name}-${this.types[s].name}`,i=document.createElement("a");i.href=window.URL.createObjectURL(new Blob([a.data])),i.setAttribute("download",e),document.body.appendChild(i),i.click(),this.$econtract.hideLoading()}))},getStatus(t){let s=parseInt(t);switch(s){case 0:return"Mới tạo lập";case 1:return"Trình ký";case 2:return"Đã nhận được tiền"}},formatAmout(t){return this.$econtract.formatAmout(parseFloat(t))}}}),c=l,d=a(1001),u=(0,d.Z)(c,o,r,!1,null,null,null),m=u.exports,h=a(2847),p=function(){var t=this,s=t._self._c;return t.isShow?s("b-modal",{ref:"modalCompleteCommission",attrs:{id:"modalCompleteCommission",title:"Hoàn thiện phiếu","no-close-on-backdrop":"",size:"md"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[s("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveTurn}},[s("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),s("button",{staticClass:"btn btn-secondary",on:{click:function(s){return t.$bvModal.hide("modalCompleteCommission")}}},[s("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}],null,!1,2755930341)},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"form-group"},[s("label",{attrs:{for:""}},[t._v("Tên đợt thanh toán")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.Turn.turn_name,expression:"Turn.turn_name"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.Turn.turn_name},on:{input:function(s){s.target.composing||t.$set(t.Turn,"turn_name",s.target.value)}}})]),s("div",{staticClass:"form-group"},[s("label",{attrs:{for:""}},[t._v("Trạng thái")]),s("select",{directives:[{name:"model",rawName:"v-model",value:t.Turn.turn_status,expression:"Turn.turn_status"}],staticClass:"form-select",on:{change:function(s){var a=Array.prototype.filter.call(s.target.options,(function(t){return t.selected})).map((function(t){var s="_value"in t?t._value:t.value;return s}));t.$set(t.Turn,"turn_status",s.target.multiple?a:a[0])}}},[s("option",{attrs:{value:"0"}},[t._v("Mới tạo lập")]),s("option",{attrs:{value:"1"}},[t._v("Trình ký")]),s("option",{attrs:{value:"2"}},[t._v("Đã nhận được tiền")])])])])])]):t._e()},f=[],_=a(9773),v=a.n(_),C={data(){return{isShow:!0,Turn:[],index:0}},methods:{show(t){this.Turn=t,this.$bvModal.show("modalCompleteCommission")},async saveTurn(){this.Turn.turn_date_payment=v()(),console.log(this.Turn.turn_date_payment),await n.Z.put("/turns/update",this.Turn).then((t=>{200==t.status&&(this.$emit("updateCommission",t.data),this.$bvModal.hide("modalCompleteCommission"),this.$toast.success("Cập nhật phiếu thanh toán thành công"))}))}}},g=C,y=(0,d.Z)(g,p,f,!1,null,null,null),b=y.exports,w=function(){var t=this,s=t._self._c;return s("b-modal",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"isShow"}],ref:"modalsearchturn",attrs:{id:"modalsearchturn",title:"Danh sách phiếu thanh toán","no-close-on-backdrop":"","no-fade":"",size:"xl","hide-footer":""}},[s("div",{staticClass:"row mb-2"},[s("div",{staticClass:"col-sm-10"},[s("div",{staticClass:"input-group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nhập mã số thuế hoặc tên doanh nghiệp để tìm kiếm...."},domProps:{value:t.keyword},on:{keyup:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.search()},input:function(s){s.target.composing||(t.keyword=s.target.value)}}})])]),s("div",{staticClass:"col-auto"},[s("button",{staticClass:"btn btn-primary-soft",attrs:{type:"button",id:"button-addon2"},on:{click:t.search}},[s("i",{staticClass:"fa-solid fa-magnifying-glass"}),t._v(" Tìm kiếm ")])])]),s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[t._v("#")]),s("th",{attrs:{width:"30%"}},[t._v("Tên công ty")]),s("th",[t._v("Mã số thuế")]),s("th",[t._v("Đợt thanh toán")]),s("th",[t._v("Ngày tạo")]),s("th",[t._v("Trạng thái")]),s("th",[t._v("Tiền hoa hồng")]),s("th",{attrs:{width:"10"}})])]),s("tbody",t._l(t.details,(function(a,e){return s("tr",{key:a.detail_id},[s("td",[t._v(t._s(e+1))]),s("td",[s("strong",{staticClass:"text-primary"},[t._v(t._s(a.company_name))])]),s("td",[t._v(t._s(a.company_taxcode))]),s("td",[t._v(t._s(a.turn_name))]),s("td",[t._v(t._s(t._f("moment")(a.turn_date,"DD/MM/YYYY")))]),s("td",[t._v(t._s(t.getStatus(a.turn_status)))]),s("td",[s("strong",{staticClass:"text-danger"},[t._v(t._s(t._f("formatamout")(a.comis_price))+"đ")])]),s("td",[s("router-link",{staticClass:"btn btn-primary-soft btn-sm",attrs:{title:"Đến phiếu thanh toán "+a.turn_name,to:{name:"commission-edit",params:{id:a.comis_id}}}},[s("i",{staticClass:"fa-solid fa-circle-arrow-right"})])],1)])})),0)]),0==t.details.length?s("NotFound"):t._e()],1)},k=[],x={name:"ModalSearchTun",components:{NotFound:h.Z},data(){return{isShow:!1,details:[],keyword:""}},methods:{show(t=null){this.isShow=!0,this.keyword=t,this.$bvModal.show("modalsearchturn"),this.getDetails()},async search(){this.getDetails()},async getDetails(){await n.Z.post("/commissionsdetail/search",{name:this.keyword}).then((t=>{this.details=t.data.data}))},getStatus(t){let s=parseInt(t);switch(s){case 0:return"Mới tạo lập";case 1:return"Trình ký";case 2:return"Đã nhận được tiền"}}},created(){}},T=x,M=(0,d.Z)(T,w,k,!1,null,null,null),$=M.exports,Z={components:{listCommissions:m,NotFound:h.Z,ModalCompleteCommisson:b,ModalSearchTurn:$},data(){return{keyword:"",partners:[],commissions:[],filter:{comis_status:1,currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),partner_id:0},months:[1,2,3,4,5,6,7,8,9,10,11,12],years:[2023,2024],debounceTimeout:null}},computed:{filterComissions(){let t=this.filter.comis_status-1,s=this.filter.partner_id;this.countTurn=this.commissions.filter((s=>t<0||s.turn_status==t));const a=this.commissions.map((a=>{const e=a.comissions.filter((a=>(0==s||a.partner.partner_id==s)&&(t<0||a.comis_status==t)));return{...a,comissions:e}}));return a},totalComission(){let t=this.filterComissions.map((t=>t.comissions.reduce(((t,s)=>t+parseFloat(s.comis_total)),0))),s=t.reduce(((t,s)=>t+parseFloat(s)),0);return s},totalVerb(){let t=this.filterComissions.reduce(((t,s)=>t+s.comissions.length),0);return t},totalAmount(){const t=this.filter.comis_status-1,s=this.turns.flatMap((t=>t.comissions)).filter((s=>t<0||s.comis_status==t)).reduce(((t,s)=>t+parseFloat(s.comis_total)),0);return s}},created(){this.getCommissions(),this.getPartners()},methods:{updateCommission(t){let s=this.filterComissions.findIndex((s=>s.turn_id==t.turn_id));this.commissions[s].turn_status=t.turn_status,this.commissions[s].comissions.length>0&&this.commissions[s].comissions.forEach((t=>{t.comis_status=this.commissions[s].turn_status})),this.$set(this.filterComissions,this.commissions)},showModalComplete(t){this.$refs.modalCompleteCommisson.show(t)},openModalSearch(){this.$refs.modalSearchTurn.show(this.keyword)},search(){this.getCommissions()},getCommissions(){this.$econtract.showLoading(),clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout((async()=>{await n.Z.post("/commissions/search",{month:this.filter.currentMonth,year:this.filter.currentYear,name:this.keyword}).then((t=>{this.commissions=t.data,this.$econtract.hideLoading()}))}),300)},async getPartners(){await n.Z.get("/partners").then((t=>{this.partners=t.data}))}}},N=Z,S=(0,d.Z)(N,e,i,!1,null,null,null),A=S.exports}}]);
//# sourceMappingURL=203.482550cb.js.map
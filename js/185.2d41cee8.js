"use strict";(self["webpackChunkecontract_frontend"]=self["webpackChunkecontract_frontend"]||[]).push([[185],{6055:function(t,a,e){e.d(a,{Z:function(){return u}});var s=function(){var t=this,a=t._self._c;return a("b-modal",{attrs:{id:"modal-complete-Contract","hide-header-close":"","no-close-on-backdrop":"",size:"md"},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(t._s(t.title)+" ")]},proxy:!0},{key:"modal-footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary",on:{click:function(a){return t.$bvModal.hide("modal-complete-Contract")}}},[a("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")]),a("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveComplete}},[a("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")])]},proxy:!0}])},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Tên công ty")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.Contract.company_name,expression:"Contract.company_name"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.Contract.company_name},on:{input:function(a){a.target.composing||t.$set(t.Contract,"company_name",a.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Ngày hoàn hiện")]),a("date-picker",{attrs:{config:t.options},model:{value:t.Contract.complete_date,callback:function(a){t.$set(t.Contract,"complete_date",a)},expression:"Contract.complete_date"}})],1),1==t.type?a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Trạng thái thanh toán")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.payment_status,expression:"payment_status"}],staticClass:"form-select",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.payment_status=a.target.multiple?e:e[0]}}},[a("option",{attrs:{value:"3"}},[t._v("Đã nộp tiền")]),a("option",{attrs:{value:"4"}},[t._v("Đã nộp tiền và làm thanh toán")])])]):t._e()])},n=[],r=e(9773),o=e.n(r),c=e(8915),i=e.n(c),l=e(1859),d={components:{datePicker:i()},data(){return{options:{format:"DD/MM/YYYY",useCurrent:!1},Contract:[],type:0,title:"Hoàn thiện hợp đồng",payment_status:3}},methods:{show(t=null,a=0){this.title=0==a?"Hoàn thiện hợp đồng":"Thanh toán hợp đồng",this.Contract=t,this.type=a,this.$bvModal.show("modal-complete-Contract")},async saveComplete(){await l.Z.put("/contracts/updatestatus",{type:this.type,payment_status:this.payment_status,contract_id:this.Contract.contract_id,complete_date:o()(this.Contract.complete_date).format("YYYY-MM-DD HH:mm:ss")}).then((t=>{"success"==t.data.message&&(this.$toast.success("Cập nhật dữ liệu thành công"),this.$emit("updateCompleteContract",t.data.data))})),this.$bvModal.hide("modal-complete-Contract")}}},p=d,h=e(1001),m=(0,h.Z)(p,s,n,!1,null,null,null),u=m.exports},2847:function(t,a,e){e.d(a,{Z:function(){return i}});var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"col flex-column text-center"},[a("svg",{attrs:{width:"100",height:"100"}},[a("svg",{attrs:{id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 208 230"}},[a("defs",[a("linearGradient",{attrs:{id:"colorNodata",x1:"133.69",y1:"120.61",x2:"73.06",y2:"91.22",gradientTransform:"matrix(1, 0, 0, -1, 0, 231.28)",gradientUnits:"userSpaceOnUse"}},[a("stop",{attrs:{offset:"0","stop-color":"#95abc2"}}),a("stop",{attrs:{offset:"1","stop-color":"#fff"}})],1),a("mask",{attrs:{id:"maskColorNodata",x:"134.5",y:"14.55",width:"17.97",height:"17.21",maskUnits:"userSpaceOnUse"}},[a("g",{attrs:{id:"handFlag"}},[a("path",{attrs:{d:"M137,24a8.1,8.1,0,0,1,8.1-8.1h6.3v6.3a8.1,8.1,0,0,1-8.1,8.1H137Z",fill:"#fff"}})])])],1),a("path",{attrs:{d:"M94.2,85.7l85.9,23.6v82.6l-85.9-37Z",fill:"#8e99a3"}}),a("path",{attrs:{d:"M94.3,85.7,24.1,105.3v86.8l70.1-37.6Z",fill:"#a0aab5"}}),a("path",{attrs:{d:"M139.4,185.9c-19.4-5.7-53.4-5.2-66.2-38.3-11.7-30.4,31.5-59.6,43.6-46.8,8.6,9.1-2.4,22.2-17.7,20.7C82,119.8,71.9,104.5,75.3,88c6.7-32.7,58.3-54.4,60.5-55.9",fill:"none","stroke-width":"3","stroke-dasharray":"6 7",stroke:"url(#colorNodata)"}}),a("path",{attrs:{d:"M141,21.5s-.5-12.3-3.7-15.6a8.4,8.4,0,0,0-11.8,11.8C128.7,21,141,21.5,141,21.5Z",fill:"#ced8e5",opacity:"0.4"}}),a("path",{attrs:{d:"M146.7,26.4s.5,12.3,3.7,15.6a8.4,8.4,0,0,0,11.8-11.8C159.1,26.9,146.7,26.4,146.7,26.4Z",fill:"#ced8e5",opacity:"0.4"}}),a("path",{attrs:{d:"M137,24a8.1,8.1,0,0,1,8.1-8.1h6.3v6.3a8.1,8.1,0,0,1-8.1,8.1H137Z",fill:"#a8b7c5"}}),a("g",{attrs:{mask:"url(#maskColorNodata)"}},[a("rect",{attrs:{x:"140.1",y:"16.7",width:"2.3",height:"16.69",transform:"translate(23.6 107.2) rotate(-45)",fill:"#dde5f2"}}),a("path",{attrs:{d:"M139.1,16.2l1.6-1.6,11.8,11.8L150.9,28Z",fill:"#dde5f2"}})]),a("path",{attrs:{d:"M159.2,12.3l5.5-1.3",fill:"none",stroke:"#8696c5","stroke-width":"0.9"}}),a("path",{attrs:{d:"M156.9,10.1l2.1-5.5",fill:"none",stroke:"#8696c5","stroke-width":"0.9"}}),a("path",{attrs:{d:"M153.7,20.5a6.1,6.1,0,1,0-6.1-6.1A6.1,6.1,0,0,0,153.7,20.5Z",fill:"#8b9aa8"}}),a("path",{attrs:{d:"M24.1,105.5,110,132.8V229L24.1,192Z",fill:"#dae2ec"}}),a("path",{attrs:{d:"M180.5,109.2l-71.7,23.6V229l71.7-37Z",fill:"#c5d0d9"}}),a("path",{attrs:{d:"M180.3,109.1,208,146.2l-73.6,29L109,132.6Z",fill:"#dae2ec"}}),a("path",{attrs:{d:"M24,105.3,0,142.8l84.6,32.4,24.7-42.7Z",fill:"#c5d0d9"}})])]),a("h4",{staticClass:"text-center font-size-20px mb-2 text-no--data text-primary"},[t._v("Chưa có dữ liệu")]),a("div",{staticClass:"text-muted"},[t._v("Hãy thêm dữ liệu hoặc Kiểm tra lại thông tin tra cứu")])])},n=[],r=e(1001),o={},c=(0,r.Z)(o,s,n,!1,null,null,null),i=c.exports},4653:function(t,a,e){e.r(a),e.d(a,{default:function(){return m}});var s=function(){var t=this,a=t._self._c;return a("div",{attrs:{id:"reports"}},[t._m(0),a("div",{staticClass:"row mb-2"},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Loại báo cáo")]),a("select2",{attrs:{options:t.reportTypes,settings:t.settings},model:{value:t.searchBy.reportType,callback:function(a){t.$set(t.searchBy,"reportType",a)},expression:"searchBy.reportType"}})],1)]),a("div",{staticClass:"col-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Tháng")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.currentMonth,expression:"searchBy.currentMonth"}],staticClass:"form-select",attrs:{name:"",id:""},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.searchBy,"currentMonth",a.target.multiple?e:e[0])}}},[a("option",{attrs:{value:"0"}},[t._v("--Chọn tháng--")]),t._l(t.months,(function(e){return a("option",{key:e},[a("option",{domProps:{value:e}},[t._v(t._s(e))])])}))],2)])]),a("div",{staticClass:"col-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Năm")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.currentYear,expression:"searchBy.currentYear"}],staticClass:"form-select",attrs:{name:"",id:""},on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.searchBy,"currentYear",a.target.multiple?e:e[0])}}},[a("option",{attrs:{value:"0"}},[t._v("--Chọn năm--")]),a("option",{attrs:{value:"2024"}},[t._v("2024")]),a("option",{attrs:{value:"2023"}},[t._v("2023")]),a("option",{attrs:{value:"2022"}},[t._v("2022")])])])])]),a("div",{staticClass:"row mb-2 collapse",attrs:{id:"collapseExample"}},[a("div",{staticClass:"col-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Mã thuê bao")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.ma_tb,expression:"searchBy.ma_tb"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tìm theo mã thuê bao"},domProps:{value:t.searchBy.ma_tb},on:{input:function(a){a.target.composing||t.$set(t.searchBy,"ma_tb",a.target.value)}}})])]),a("div",{staticClass:"col-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Mã lắp đặt")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.contract_code,expression:"searchBy.contract_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tìm theo mã lắp đặt"},domProps:{value:t.searchBy.contract_code},on:{input:function(a){a.target.composing||t.$set(t.searchBy,"contract_code",a.target.value)}}})])]),a("div",{staticClass:"col-3"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Đầu mối liên hệ")]),a("select2",{attrs:{options:t.customers,settings:t.settings},model:{value:t.searchBy.customer_id,callback:function(a){t.$set(t.searchBy,"customer_id",a)},expression:"searchBy.customer_id"}})],1)])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("button",{staticClass:"btn btn-primary-soft me-1",on:{click:function(a){return t.searchReport()}}},[a("i",{staticClass:"fa-thin fa-magnifying-glass"}),t._v(" Tìm kiếm")]),t._m(1),a("button",{staticClass:"btn btn-success",on:{click:t.exportExcel}},[a("i",{staticClass:"fa-thin fa-file-excel"}),t._v(" Xuất Excel")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("table",{staticClass:"table table-responsive"},[t._m(2),a("tbody",[a("tr",[a("td"),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.company_name,expression:"searchBy.company_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tìm tên công ty"},domProps:{value:t.searchBy.company_name},on:{input:function(a){a.target.composing||t.$set(t.searchBy,"company_name",a.target.value)}}})]),a("td"),a("td"),a("td"),a("td"),a("td"),a("td"),a("td"),a("td")]),t._l(t.reportFilterd,(function(e,s){return a("tr",{key:e.contract_id},[a("td",[t._v(t._s(s+1))]),a("td",[a("router-link",{attrs:{title:e.company_name,to:{name:"contract-edit",params:{id:e.contract_id}}}},[a("span",{staticClass:"text-capitalize"},[t._v(t._s(e.company_name))])]),e.contract_note?a("div",[a("i",{staticClass:"fa-regular fa-notes me-1"}),a("i",{staticClass:"text-danger fw-bold"},[t._v(t._s(e.contract_note))])]):t._e()],1),a("td",[t._v(t._s(e.company_taxcode))]),a("td",[t._v(t._s(t._f("moment")(e.contract_date,"DD/MM/YYYY")))]),a("td",{domProps:{innerHTML:t._s(t.contractType(e.contract_type))}}),a("td",[t._v(t._s(t._f("moment")(e.complete_date,"DD/MM/YYYY")))]),a("td",{domProps:{innerHTML:t._s(t.contractStatus(e.contract_status))}}),4==e.contract_payment&&3==e.contract_status?[a("td",[a("span",{staticClass:"text-small"},[t._v(t._s(t._f("moment")(e.contract_payment_date,"DD/MM/YYYY H:mm:ss")))])])]:[a("td",{domProps:{innerHTML:t._s(t.contractPayment(e.contract_payment))}})],a("td",{staticClass:"text-end"},[a("strong",{staticClass:"text-danger"},[t._v(t._s(t._f("formatamout")(e.contract_total,0)))])]),a("td",[a("div",{staticClass:"dropdown"},[t._m(3,!0),a("ul",{staticClass:"dropdown-menu"},[a("li",[a("router-link",{staticClass:"dropdown-item hand",attrs:{to:{name:"contract-detail",params:{id:e.contract_id}}}},[a("i",{staticClass:"fa-thin fa-circle-info"}),t._v(" Xem chi tiết ")])],1),a("li",[a("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"contract-edit",params:{id:e.contract_id}}}},[a("i",{staticClass:"fa-thin fa-pen-to-square"}),t._v(" Cập nhật hợp đồng ")])],1),e.contract_status<3?a("li",[a("a",{staticClass:"dropdown-item hand",on:{click:function(a){return t.completeContract(e,0)}}},[a("i",{staticClass:"fa-thin fa-circle-check"}),t._v(" Hoàn thiện hợp đồng")])]):t._e(),e.contract_payment<3?a("li",[a("a",{staticClass:"dropdown-item hand",on:{click:function(a){return t.completeContract(e,1)}}},[a("i",{staticClass:"fa-thin fa-circle-dollar"}),t._v(" Thanh toán hợp đồng")])]):t._e(),a("li",[a("router-link",{staticClass:"dropdown-item hand",attrs:{title:"Tùy chỉnh hợp đồng",to:{name:"contract-option",params:{id:e.contract_id}}}},[a("i",{staticClass:"fa-thin fa-gear"}),t._v(" Tùy chỉnh hợp đồng ")])],1),t._m(4,!0),a("li",[a("a",{staticClass:"dropdown-item hand",on:{click:function(a){return t.cancelContract(e,s)}}},[t._m(5,!0)])])])])])],2)}))],2)]),0==t.reports.length?a("not-found"):t._e(),a("completeContract",{ref:"completeContract",on:{updateCompleteContract:t.updateCompleteContract}})],1)])])},n=[function(){var t=this,a=t._self._c;return a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("h1",{staticClass:"fw-bold title-page"},[t._v("Báo cáo tổng hợp")])])])},function(){var t=this,a=t._self._c;return a("button",{staticClass:"btn btn-primary-soft me-1",attrs:{"data-bs-toggle":"collapse",href:"#collapseExample",role:"button","aria-expanded":"false","aria-controls":"collapseExample"}},[a("i",{staticClass:"fa-thin fa-filter-list"}),t._v(" Nâng cao")])},function(){var t=this,a=t._self._c;return a("thead",[a("tr",[a("th",[t._v("#")]),a("th",{attrs:{width:"30%"}},[t._v("Tên công ty")]),a("th",[t._v("Mã số thuế")]),a("th",[t._v("Ngày HĐ")]),a("th",[t._v("Hình thức")]),a("th",[t._v("Ngày xuất HĐ")]),a("th",{attrs:{width:"4%"}},[t._v("HT")]),a("th",{attrs:{width:"7%"}},[t._v("Thanh toán")]),a("th",[t._v("Tổng tiền")]),a("th")])])},function(){var t=this,a=t._self._c;return a("button",{staticClass:"btn btn-sm border-0",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[a("i",{staticClass:"fa-solid fa-ellipsis-vertical"})])},function(){var t=this,a=t._self._c;return a("li",[a("hr",{staticClass:"dropdown-divider"})])},function(){var t=this,a=t._self._c;return a("strong",{staticClass:"text-danger"},[a("i",{staticClass:"fa-thin fa-trash-can"}),t._v(" Hủy hợp đồng")])}],r=(e(8858),e(1318),e(3228),e(1859)),o=e(8881),c=e(2847),i=e(6055),l={components:{Select2:o.Z,notFound:c.Z,completeContract:i.Z},data(){return{reports:[],searchBy:{reportType:0,currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),ma_tb:"",company_name:"",customer_id:0},reportTypes:[{id:1,text:"Tất cả hợp đồng trong tháng"},{id:2,text:"Phát triển mới trong tháng"},{id:3,text:"Hợp đồng gia hạn trong tháng"},{id:4,text:"Hợp đồng chưa hoàn thiện & chưa xuất hóa đơn trong tháng"},{id:5,text:"Hợp đồng đã hoàn thiện & xuất hóa đơn trong tháng"},{id:6,text:"Hợp đồng đã hủy"}],settings:{placeholder:"--Hãy chọn dữ liệu--",theme:"bootstrap-5",width:"100%"},months:12,currentMonth:(new Date).getMonth()+1,currentYear:(new Date).getFullYear(),customers:[]}},created(){this.getCustomers()},computed:{reportFilterd(){return this.reports.filter((t=>-1!==t.company_name.toLowerCase().indexOf(this.searchBy.company_name.toLowerCase())))}},methods:{async getCustomers(){await r.Z.get("customers").then((t=>{this.customers=t.data.map((t=>({id:t.customer_id,text:t.customer_name})))}))},async searchReport(){this.getReports()},async getReports(){this.$econtract.showLoading(),await r.Z.post("reports/search",{ReportType:{type:this.searchBy.reportType,month:this.searchBy.currentMonth,year:this.searchBy.currentYear},matb:this.searchBy.ma_tb,contractCode:this.searchBy.contractCode,customer:this.searchBy.customer_id}).then((t=>{this.reports=t.data,this.$econtract.hideLoading()}))},async exportExcel(){this.$econtract.showLoading(),await r.Z.post("reports",{ReportType:{type:this.searchBy.reportType,month:this.searchBy.currentMonth,year:this.searchBy.currentYear},matb:this.searchBy.ma_tb,contractCode:this.searchBy.contractCode},{responseType:"blob"}).then((t=>{const a=window.URL.createObjectURL(new Blob([t.data])),e=document.createElement("a");e.href=a,e.setAttribute("download","reports.xlsx"),document.body.appendChild(e),e.click(),this.$econtract.hideLoading()}))},updateCompleteContract(t){let a=this.contracts.filter((a=>a.contract_id==t.contract_id))[0];a.contract_status=t.contract_status,a.contract_payment=t.contract_payment},completeContract(t,a){this.$refs.completeContract.show(t,a)},cancelContract(t,a){this.$emit("cancelContract",t,a)},cancelContract(t,a){this.$emit("cancelContract",t,a)},contractType(t){return 0==t?' <span class="badge text-bg-success bg-opacity-10 text-black">\n                  Đăng ký mới\n                </span>':' <span class="badge text-bg-warning bg-opacity-10 text-black">\n                  Gia hạn\n                </span>'},contractStatus(t){return 0==t?' <span class="badge text-bg-danger bg-opacity-10 text-black">\n                  Mới tạo lập\n                </span>':1==t?' <span class="badge text-bg-danger bg-opacity-10 text-black">\n                  Trình ký\n                </span>':2==t?' <span class="badge text-bg-danger bg-opacity-10 text-black">\n                  Đã gửi KH\n                </span>':3==t?' <span class="badge text-bg-success bg-opacity-10 text-black">\n                  Hoàn thiện\n                </span>':' <span class="badge text-bg-success bg-opacity-10 text-black">\n                  Đã làm thanh toán\n                </span>'},contractPayment(t){return 0==t?' <span class="badge text-bg-danger bg-opacity-10 text-black">\n                  Chưa thanh toán\n                </span>':1==t?' <span class="badge text-bg-danger bg-opacity-10 text-black">\n                  Đã nhận tiền nhưng chưa nộp tiền\n                </span>':2==t?' <span class="badge text-bg-warning text-wrap bg-opacity-10 text-black" style="width:6rem">\n                  Đã xuất hóa đơn nhưng chưa nộp tiền\n                </span>':' <span class="badge text-bg-success bg-opacity-10 text-wrap text-black" style="width:6rem">\n                   Đã nộp tiền và xuất hóa đơn\n                </span>'}}},d=l,p=e(1001),h=(0,p.Z)(d,s,n,!1,null,null,null),m=h.exports}}]);
//# sourceMappingURL=185.2d41cee8.js.map
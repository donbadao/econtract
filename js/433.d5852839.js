"use strict";(self["webpackChunkecontract_frontend"]=self["webpackChunkecontract_frontend"]||[]).push([[433],{2433:function(t,e,c){c.r(e),c.d(e,{default:function(){return b}});var s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"product-list"}},[e("h1",{staticClass:"fw-bold title-page"},[t._v("Danh sách dịch vụ")]),e("div",{staticClass:"row mb-2"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"search",placeholder:"Nhập tên dịch vụ để tìm kiếm...."},domProps:{value:t.keyword},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search()},input:function(e){e.target.composing||(t.keyword=e.target.value)}}}),e("button",{staticClass:"btn btn-primary-soft",attrs:{type:"button",id:"button-addon2"},on:{click:function(e){return t.search()}}},[e("i",{staticClass:"fa-solid fa-magnifying-glass"}),t._v(" Tìm kiếm ")]),e("button",{staticClass:"btn btn-primary-soft ms-1",on:{click:t.addProduct}},[e("i",{staticClass:"fa-duotone fa-circle-plus"}),t._v(" Thêm dịch vụ")])])])]),e("product-list",{attrs:{products:t.products},on:{deleteProduct:t.deleteProduct,updateProduct:t.updateProduct}}),e("productAdd",{ref:"productAdd",on:{updateProductSuccess:t.updateProductSuccess,addProductSuccess:t.addProductSuccess}})],1)},o=[],r=(c(560),function(){var t=this,e=t._self._c;return e("div",[e("table",{staticClass:"table"},[t._m(0),e("tbody",t._l(t.products,(function(c,s){return e("tr",{key:c.product_id},[e("td",[t._v(t._s(s+1))]),e("td",[e("span",{staticClass:"text-primary hand",attrs:{title:c.product_name},on:{click:function(e){return t.show(c)}}},[t._v(" "+t._s(c.product_name)+" ")])]),e("td",[t._v(t._s(c.cate_name))]),e("td",[t._v(t._s(t._f("formatamout")(c.product_price,4)))]),e("td",[t._v(t._s(c.product_component_price))]),e("td",[e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model.lazy",value:c.product_split,expression:"product.product_split",modifiers:{lazy:!0}}],staticClass:"form-check-input",attrs:{type:"checkbox"},domProps:{checked:c.product_split,checked:Array.isArray(c.product_split)?t._i(c.product_split,null)>-1:c.product_split},on:{change:[function(e){var s=c.product_split,o=e.target,r=!!o.checked;if(Array.isArray(s)){var a=null,d=t._i(s,a);o.checked?d<0&&t.$set(c,"product_split",s.concat([a])):d>-1&&t.$set(c,"product_split",s.slice(0,d).concat(s.slice(d+1)))}else t.$set(c,"product_split",r)},function(e){return t.updateProduct(c)}]}})])]),e("td",[e("button",{staticClass:"btn btn-primary-soft btn-sm",on:{click:function(e){return t.show(c)}}},[e("i",{staticClass:"fa-thin fa-pen-to-square"})]),e("button",{staticClass:"btn btn-danger-soft btn-sm ms-1",on:{click:function(e){return t.deleteProduct(c,s)}}},[e("i",{staticClass:"fa-thin fa-trash-alt"})])])])})),0)])])}),a=[function(){var t=this,e=t._self._c;return e("thead",{staticClass:"table-dark"},[e("tr",[e("th",{staticClass:"rounded-start"},[t._v("#")]),e("th",[t._v("Tên dịch vụ")]),e("th",[t._v("Nhóm dịch vụ")]),e("th",[t._v("Giá dịch vụ")]),e("th",[t._v("Giá thành phần")]),e("th",[t._v("Phân rã")]),e("th",{staticClass:"rounded-end"})])])}],d={props:{products:Array},methods:{async updateProduct(t){let e=t;await axios.put(`${API_URL}/products/update`,e).then((t=>{200==t.status&&(this.$toast.success("Cập nhật dịch vụ thành công"),this.$emit("updateProductSuccess",e))}))},show(t){this.$emit("updateProduct",t)},deleteProduct(t,e){this.$emit("deleteProduct",t,e)}}},i=d,u=c(1001),n=(0,u.Z)(i,r,a,!1,null,null,null),l=n.exports,p=function(){var t=this,e=t._self._c;return e("b-modal",{ref:"modalDetail",attrs:{id:"modal-add-product","hide-header-close":"","no-close-on-backdrop":"","no-fade":"",size:"md","ignore-enforce-focus-selector":"span.select2-container",title:"Thêm dịch vụ"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[e("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveProduct}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return t.$bvModal.hide("modal-add-product")}}},[e("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Tên dịch vụ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Product.product_name,expression:"Product.product_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tên dịch vụ"},domProps:{value:t.Product.product_name},on:{input:function(e){e.target.composing||t.$set(t.Product,"product_name",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Giá dịch vụ")]),e("money",t._b({staticClass:"form-control",model:{value:t.Product.product_price,callback:function(e){t.$set(t.Product,"product_price",e)},expression:"Product.product_price"}},"money",t.money,!1))],1),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Giá thành phần")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Product.product_component_price,expression:"Product.product_component_price"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Giá thành phần"},domProps:{value:t.Product.product_component_price},on:{input:function(e){e.target.composing||t.$set(t.Product,"product_component_price",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Nhóm dịch vụ")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.Product.cate_id,expression:"Product.cate_id"}],staticClass:"form-select",on:{change:function(e){var c=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Product,"cate_id",e.target.multiple?c:c[0])}}},[e("option",{attrs:{value:"0"}},[t._v("--Chọn nhóm dịch vụ--")]),t._l(t.categories,(function(c){return e("option",{key:c.cate_id,domProps:{value:c.cate_id}},[t._v(" "+t._s(c.cate_name)+" ")])}))],2)]),e("div",{staticClass:"form-group mt-2"},[e("div",{staticClass:"form-check"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.Product.product_split,expression:"Product.product_split"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"flexCheckDefault"},domProps:{value:t.Product.product_split,checked:Array.isArray(t.Product.product_split)?t._i(t.Product.product_split,t.Product.product_split)>-1:t.Product.product_split},on:{change:function(e){var c=t.Product.product_split,s=e.target,o=!!s.checked;if(Array.isArray(c)){var r=t.Product.product_split,a=t._i(c,r);s.checked?a<0&&t.$set(t.Product,"product_split",c.concat([r])):a>-1&&t.$set(t.Product,"product_split",c.slice(0,a).concat(c.slice(a+1)))}else t.$set(t.Product,"product_split",o)}}}),e("label",{staticClass:"form-check-label",attrs:{for:"flexCheckDefault"}},[t._v(" Phân rã ")])])])])])])},h=[],m=c(1859),_=c(4838),v={components:{Money:_.Money},data(){return{Product:{product_name:"",cate_id:0,product_component_price:0,product_split:!1,product_price:0},categories:[],isUpdate:!1,money:{decimal:",",thousands:".",prefix:"",suffix:" ",precision:4,masked:!1}}},created(){this.getCategories()},methods:{async saveProduct(){this.$econtract.showLoading(),this.isUpdate?await m.Z.put("/products/update",this.Product).then((t=>{200==t.status&&(this.$toast.success("Cập nhật dịch vụ thành công"),this.$emit("updateProductSuccess",t.data),localStorage.removeItem("nhl_products"),this.hide())})):await m.Z.post("/products",this.Product).then((t=>{200==t.status&&(this.$toast.success("Thêm dịch vụ thành công"),this.$emit("addProductSuccess",t.data),localStorage.removeItem("nhl_products"),this.hide())})),this.$econtract.hideLoading()},hide(){this.$bvModal.hide("modal-add-product")},show(t){t?(this.Product=t,delete this.Product.cate_name,delete this.Product.cate_icon,delete this.Product.cate_list_check,delete this.Product.pattern_contract,this.isUpdate=!0):this.Product={},this.$bvModal.show("modal-add-product")},async getCategories(){await m.Z.get("/categories").then((t=>{this.categories=t.data}))}}},f=v,P=(0,u.Z)(f,p,h,!1,null,null,null),y=P.exports,k={components:{productList:l,productAdd:y},computed:{products(){return this.productList.filter((t=>-1!==t.product_name.toLowerCase().indexOf(this.keyword.toLowerCase())))}},data(){return{productList:[],keyword:""}},created(){this.getProducts()},methods:{search(){this.products=this.products.filter((t=>-1!==t.product_name.toLowerCase().indexOf(this.keyword.toLowerCase())))},deleteProduct(t,e){this.$confirm({title:"Xóa dịch vụ",message:"Bạn có muốn xóa dịch vụ?",button:{yes:"Yes",no:"No"},callback:c=>{c&&m.Z.delete(`${API_URL}/products/${t.product_id}`).then((t=>{200==t.status&&(this.products.splice(e,1),this.$toast.success("Xóa dịch vụ thành công"))}))}})},updateProductSuccess(t){},updateProduct(t){this.$refs.productAdd.show(t)},addProductSuccess(t){this.productList.push(t)},addProduct(){this.$refs.productAdd.show()},async getProducts(){await m.Z.get("/products").then((t=>this.productList=t.data))}}},C=k,g=(0,u.Z)(C,s,o,!1,null,null,null),b=g.exports}}]);
//# sourceMappingURL=433.d5852839.js.map
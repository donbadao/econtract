"use strict";(self["webpackChunkecontract_frontend"]=self["webpackChunkecontract_frontend"]||[]).push([[557],{3669:function(t,e,a){a.d(e,{Z:function(){return h}});var s=function(){var t=this,e=t._self._c;return e("b-modal",{ref:"modalDetail",attrs:{id:"modal-add-customer","hide-header-close":"","no-close-on-backdrop":"","no-fade":"",size:"md","ignore-enforce-focus-selector":"span.select2-container",title:"Thêm người liên hệ"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[e("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveCustomer}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return t.$bvModal.hide("modal-add-customer")}}},[e("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Tên người liên hệ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Customer.customer_name,expression:"Customer.customer_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tên người liên hệ"},domProps:{value:t.Customer.customer_name},on:{input:function(e){e.target.composing||t.$set(t.Customer,"customer_name",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Số điện thoại người liên hệ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Customer.customer_phone,expression:"Customer.customer_phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Số điện thoại người liên hệ"},domProps:{value:t.Customer.customer_phone},on:{input:function(e){e.target.composing||t.$set(t.Customer,"customer_phone",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Email người liên hệ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Customer.customer_email,expression:"Customer.customer_email"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Email người liên hệ"},domProps:{value:t.Customer.customer_email},on:{input:function(e){e.target.composing||t.$set(t.Customer,"customer_email",e.target.value)}}})]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ngày sinh người liên hệ")]),e("date-picker",{attrs:{config:t.options},model:{value:t.Customer.customer_birthday,callback:function(e){t.$set(t.Customer,"customer_birthday",e)},expression:"Customer.customer_birthday"}})],1)])},o=[],i=a(8915),r=a.n(i),n=a(9773),c=a.n(n),l=a(1859),d={components:{datePicker:r()},data(){return{Customer:{customer_name:"",customer_phone:0,customer_id:0,customer_email:"",customer_birthday:this.$econtract.formatDate(new Date)},options:{format:"DD/MM/YYYY",useCurrent:!1},isUpdate:!1}},methods:{async saveCustomer(){this.isUpdate?await l.Z.put("/customers/update",this.Customer).then((t=>{200==t.status&&(this.$toast.success("Cập nhật người liên hệ thành công"),this.$emit("addCustomerSuccess",t.data),this.$bvModal.hide("modal-add-customer"))})):await l.Z.post("/customers",this.Customer).then((t=>{200==t.status&&(this.$toast.success("Thêm người liên hệ thành công"),this.$emit("addCustomerSuccess",t.data),this.$bvModal.hide("modal-add-customer"))}))},show(t=null,e=!1){e&&(this.Customer=t,this.Customer.customer_birthday=c()(t.customer_birthday).format("DD/MM/YYYY")),this.isUpdate=e,this.$bvModal.show("modal-add-customer")}}},m=d,u=a(1001),p=(0,u.Z)(m,s,o,!1,null,null,null),h=p.exports},7557:function(t,e,a){a.r(e),a.d(e,{default:function(){return dt}});var s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"contract-crate"}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"card border-0"},[e("div",{staticClass:"card-body"},[e("h1",{staticClass:"fw-bold title-page"},[t._v("Lập hợp đồng")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"yourInput"}},[t._v("Danh sách công ty")]),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.Contract.company_name,expression:"Contract.company_name",modifiers:{lazy:!0}}],staticClass:"form-control",attrs:{disabled:"",type:"text",placeholder:"Danh sách công ty"},domProps:{value:t.Contract.company_name},on:{change:function(e){return t.$set(t.Contract,"company_name",e.target.value)}}}),e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button",id:"button-addon3"},on:{click:t.openModalCompany}},[e("i",{staticClass:"fa-thin fa-magnifying-glass"})])])])]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"yourInput"}},[t._v("Đầu mối liên hệ")]),e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.Contract.customer_name,expression:"Contract.customer_name",modifiers:{lazy:!0}}],staticClass:"form-control",attrs:{disabled:"",type:"text",placeholder:"Đầu mối liên hệ"},domProps:{value:t.Contract.customer_name},on:{change:function(e){return t.$set(t.Contract,"customer_name",e.target.value)}}}),e("button",{staticClass:"input-group-text",attrs:{title:"Thêm người liên hệ"},on:{click:t.addCustomer}},[e("i",{staticClass:"fa-solid fa-plus"})]),e("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button",id:"button-addon2"},on:{click:t.openModalCustomer}},[e("i",{staticClass:"fa-thin fa-magnifying-glass"})])])])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Số hợp đồng")]),e("div",{staticClass:"input-group mb-3"},[e("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.Contract.contract_number,expression:"Contract.contract_number",modifiers:{lazy:!0}}],staticClass:"form-control",attrs:{placeholder:"Nhập số hợp đồng",type:"text","aria-label":"Text input with segmented dropdown button",required:""},domProps:{value:t.Contract.contract_number},on:{change:function(e){return t.$set(t.Contract,"contract_number",e.target.value)}}}),e("select",{directives:[{name:"model",rawName:"v-model",value:t.Contract.contract_number_pattern,expression:"Contract.contract_number_pattern"}],staticClass:"form-select",attrs:{id:"inputGroupSelect01"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"contract_number_pattern",e.target.multiple?a:a[0])}}},t._l(t.selects.contract_number_pattern_list,(function(a){return e("option",{key:a},[t._v(" "+t._s(a)+" ")])})),0)])])]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ngày hợp đồng")]),e("date-picker",{attrs:{config:t.options},model:{value:t.Contract.contract_date,callback:function(e){t.$set(t.Contract,"contract_date",e)},expression:"Contract.contract_date"}})],1)])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ghi chú hợp đồng")]),e("textarea",{directives:[{name:"model",rawName:"v-model.lazy",value:t.Contract.contract_note,expression:"Contract.contract_note",modifiers:{lazy:!0}}],staticClass:"form-control",attrs:{rows:"1",placeholder:"Nhập ghi chú hợp đồng"},domProps:{value:t.Contract.contract_note},on:{change:function(e){return t.$set(t.Contract,"contract_note",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Loại hợp đồng")]),e("select",{directives:[{name:"model",rawName:"v-model.lazy",value:t.Contract.contract_type,expression:"Contract.contract_type",modifiers:{lazy:!0}}],staticClass:"form-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"contract_type",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:"0"}},[t._v("Đăng ký mới")]),e("option",{attrs:{value:"1"}},[t._v("Gia hạn")])])])]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Tháng đăng ký hợp đồng")]),e("select",{directives:[{name:"model",rawName:"v-model.lazy",value:t.Contract.contract_expired_month,expression:"Contract.contract_expired_month",modifiers:{lazy:!0}}],staticClass:"form-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"contract_expired_month",e.target.multiple?a:a[0])}}},t._l(t.dateChooses,(function(a){return e("option",{key:a.id,domProps:{value:a.id}},[t._v(" "+t._s(a.text)+" ")])})),0)])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ngày bắt đầu")]),e("date-picker",{attrs:{config:t.options},model:{value:t.Contract.contract_date_start,callback:function(e){t.$set(t.Contract,"contract_date_start",e)},expression:"Contract.contract_date_start"}})],1)]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ngày hết hạn")]),e("date-picker",{attrs:{config:t.options},model:{value:t.Contract.contract_date_end,callback:function(e){t.$set(t.Contract,"contract_date_end",e)},expression:"Contract.contract_date_end"}})],1)])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Trạng thái hợp đồng")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.Contract.contract_status,expression:"Contract.contract_status"}],staticClass:"form-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"contract_status",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:"0"}},[t._v("Mới tạo lập")]),e("option",{attrs:{value:"1"}},[t._v("Đã trình ký")]),e("option",{attrs:{value:"2"}},[t._v("Đã gửi khách hàng")]),e("option",{attrs:{value:"3"}},[t._v("Hoàn thiện")]),e("option",{attrs:{value:"4"}},[t._v("Đã làm thanh toán")])])])]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Trạng thái thanh toán")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.Contract.contract_payment,expression:"Contract.contract_payment"}],staticClass:"form-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"contract_payment",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:"0"}},[t._v("Chưa thanh toán")]),e("option",{attrs:{value:"1"}},[t._v("Đã nhận tiền nhưng chưa nộp tiền")]),e("option",{attrs:{value:"2"}},[t._v(" Đã xuất hóa đơn nhưng chưa thu tiền khách hàng ")]),e("option",{attrs:{value:"3"}},[t._v("Đã nộp tiền")]),e("option",{attrs:{value:"4"}},[t._v("Đã nộp tiền và làm thanh toán")])])])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Khu vực tính doanh thu")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.Contract.contract_area,expression:"Contract.contract_area"}],staticClass:"form-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"contract_area",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:"0"}},[t._v("Thành phố")]),e("option",{attrs:{value:"1"}},[t._v("Huyện (Khác)")])])])]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Mã hợp đồng/Thanh toán")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Contract.contract_code,expression:"Contract.contract_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Mã hợp đồng/Mã thanh toán"},domProps:{value:t.Contract.contract_code},on:{input:function(e){e.target.composing||t.$set(t.Contract,"contract_code",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Mã BHXH/Số lượng hóa đơn")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Contract.extra1,expression:"Contract.extra1"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Mã BHXH/Số lượng hóa đơn"},domProps:{value:t.Contract.extra1},on:{input:function(e){e.target.composing||t.$set(t.Contract,"extra1",e.target.value)}}})])]),e("div",{staticClass:"col-6 col-md-6 col-sm-12 col-xs12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ký hiệu/Mẫu số")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Contract.extra2,expression:"Contract.extra2"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ký hiệu/Mẫu số"},domProps:{value:t.Contract.extra2},on:{input:function(e){e.target.composing||t.$set(t.Contract,"extra2",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Tỷ lệ hợp đồng")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.Contract.ratio_id,expression:"Contract.ratio_id"}],staticClass:"form-select",on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.Contract,"ratio_id",e.target.multiple?a:a[0])}}},[e("option",{attrs:{value:"0"}},[t._v("--Hãy chọn dữ liệu---")]),t._l(t.ratios,(function(a){return e("option",{key:a.ratio_id,domProps:{value:a.ratio_id}},[t._v(" "+t._s(a.ratio_name)+" ")])}))],2)])])]),e("div",{staticClass:"row mt-2"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"btn-group mb-2 mt-1 d-inline"},[t._m(0),e("ul",{staticClass:"dropdown-menu"},[e("li",[e("a",{staticClass:"dropdown-item hand",attrs:{title:"Thêm dịch vụ"},on:{click:function(e){return t.addDetail()}}},[e("i",{staticClass:"fa-thin fa-grid-2-plus"}),t._v(" Thêm dịch vụ")])]),e("li",[e("a",{staticClass:"dropdown-item hand",attrs:{title:"Chọn mẫu hợp đồng"},on:{click:function(e){return t.addTemplates()}}},[e("i",{staticClass:"fa-thin fa-layer-plus"}),t._v(" Chọn mẫu hợp đồng")])]),e("li",[e("a",{staticClass:"dropdown-item hand",attrs:{title:"Thêm phiếu đăng ký"},on:{click:function(e){return t.addRegistration()}}},[e("i",{staticClass:"fa-thin fa-user-plus"}),t._v(" Thêm phiếu đăng ký")])]),e("li",[e("a",{staticClass:"dropdown-item hand",attrs:{title:"Chọn phiếu đăng ký"},on:{click:function(e){return t.chooseRegistration()}}},[e("i",{staticClass:"fa-light fa-folder-open"}),t._v(" Chọn phiếu đăng ký")])])])]),e("router-link",{staticClass:"btn btn-primary-soft ms-2",attrs:{to:{name:"contract-option",params:{id:t.contract_id}}}},[e("i",{staticClass:"fa-regular fa-gear"}),t._v(" Tùy chỉnh hợp đồng ")]),t.isUpdate?e("div",{staticClass:"ms-2 d-inline"},t._l(t.Contract.templates,(function(a){return e("span",{key:a.temp_id,staticClass:"badge text-bg-light text-dark border p-2 ms-1"},[t._v(" "+t._s(a.temp_name)+" ")])})),0):t._e(),e("ul",{staticClass:"nav nav-pills mb-2 bg-light mt-2",attrs:{id:"pills-tab",role:"tablist"}},[t._m(1),e("li",{staticClass:"nav-item",attrs:{role:"presentation"}},[e("button",{staticClass:"nav-link position-relative",attrs:{id:"pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#pills-profile",type:"button",role:"tab","aria-controls":"pills-profile","aria-selected":"false"}},[t._v(" Danh sách phiếu đăng ký "),e("span",{staticClass:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},[t._v(" "+t._s(t.Contract.registrations.length)+" ")])])])]),e("div",{staticClass:"tab-content",attrs:{id:"pills-tabContent"}},[e("div",{staticClass:"tab-pane fade show active",attrs:{id:"pills-home",role:"tabpanel","aria-labelledby":"pills-home-tab",tabindex:"0"}},[e("div",{staticClass:"table-responsive table-scroll"},[t.filteredDetails.length>0?e("table",{staticClass:"table table-dark-gray align-middle p-4 mb-0 table-hover"},[t._m(2),e("tbody",t._l(t.Contract.details,(function(a,s){return e("contractDetail",{key:"rows_"+s+"_"+a.contract_id,attrs:{detail:a,index:s},on:{sendDetail:t.sendDetail,deleteDetail:t.deleteDetail}})})),1)]):t._e()]),0==t.filteredDetails.length?[e("not-found")]:t._e()],2),e("div",{staticClass:"tab-pane fade",attrs:{id:"pills-profile",role:"tabpanel","aria-labelledby":"pills-profile-tab",tabindex:"0"}},[0==t.Contract.registrations.length?[e("not-found")]:t._e(),t.Contract.registrations.length>0?e("table",{staticClass:"table table-dark-gray align-middle p-4 mb-0 table-hover mt-2"},[t._m(3),t._l(t.filteredRegistrations,(function(a,s){return e("regDetail",{key:s+1,attrs:{registration:a,index:s},on:{sendRegistration:t.sendRegistration,deleteRegistration:t.deleteRegistration}})}))],2):t._e(),e("div",{staticClass:"text-center"},[e("button",{staticClass:"btn btn-primary-soft mt-2 btn-sm",on:{click:function(e){return t.chooseRegistration()}}},[e("i",{staticClass:"fa-light fa-folder-open"}),t._v(" Chọn phiếu đăng ký ")])])],2)]),t.isLoadingTable?e("div",{staticClass:"d-flex justify-content-center"},[t._m(4)]):t._e()],1)]),e("div",{staticClass:"d-flex align-items-end flex-column"},[e("div",{staticClass:"row mt-2"},[t._m(5),e("div",{staticClass:"col-auto"},[e("money",t._b({staticClass:"form-control text-end",model:{value:t.Contract.subTotal,callback:function(e){t.$set(t.Contract,"subTotal",e)},expression:"Contract.subTotal"}},"money",t.money,!1))],1)]),e("div",{staticClass:"row mt-2"},[t._m(6),e("div",{staticClass:"col-auto"},[e("money",t._b({staticClass:"form-control text-end",nativeOn:{change:function(e){return t.changeTax.apply(null,arguments)}},model:{value:t.Contract.contract_tax,callback:function(e){t.$set(t.Contract,"contract_tax",e)},expression:"Contract.contract_tax"}},"money",t.money,!1))],1)]),e("div",{staticClass:"row mt-2"},[t._m(7),e("div",{staticClass:"col-auto"},[e("money",t._b({staticClass:"form-control text-end",model:{value:t.Contract.contract_total,callback:function(e){t.$set(t.Contract,"contract_total",e)},expression:"Contract.contract_total"}},"money",t.money,!1))],1)])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v(" Tiền bằng chữ ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Contract.contract_price_text,expression:"Contract.contract_price_text"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Thành tiền bằng chữ"},domProps:{value:t.Contract.contract_price_text},on:{input:function(e){e.target.composing||t.$set(t.Contract,"contract_price_text",e.target.value)}}})])])])]),e("div",{staticClass:"card-footer border-top-0"},[e("router-link",{staticClass:"btn btn-secondary",attrs:{to:{name:"contract-index"}}},[e("i",{staticClass:"fa-thin fa-arrow-left"}),t._v(" Quay lại ")]),e("button",{staticClass:"btn btn-primary-soft ms-1",on:{click:function(e){return t.store()}}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")])],1)])])]),e("contract-option-modal",{ref:"contractoption",on:{updateContractOption:t.updateContractOption}}),e("modelAddDetail",{ref:"modalDetail",on:{saveDetail:t.saveDetail}}),e("modal-templates",{ref:"modalTemplate",attrs:{templateSelecteds:t.templateSelected},on:{saveTemplate:t.saveTemplate}}),e("modal-registration",{ref:"modalRegistration",on:{saveRegistration:t.saveRegistration}}),e("modal-companies",{ref:"modalcompanies",on:{chooseCompany:t.chooseCompany}}),e("modal-customers",{ref:"modalcustomers",on:{chooseCustomer:t.chooseCustomer}}),e("modal-customer-add",{ref:"modalcustomeradd",on:{addCustomerSuccess:t.addCustomerSuccess}}),e("modal-registration-list",{ref:"registrationList",on:{reviceRegistration:t.reviceRegistration}})],1)},o=[function(){var t=this,e=t._self._c;return e("button",{staticClass:"btn btn-danger dropdown-toggle",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[e("i",{staticClass:"fa-duotone fa-circle-plus"}),t._v(" Thêm ")])},function(){var t=this,e=t._self._c;return e("li",{staticClass:"nav-item",attrs:{role:"presentation"}},[e("button",{staticClass:"nav-link active",attrs:{id:"pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#pills-home",type:"button",role:"tab","aria-controls":"pills-home","aria-selected":"true"}},[t._v(" Danh sách dịch vụ ")])])},function(){var t=this,e=t._self._c;return e("thead",{staticClass:"table-dark"},[e("tr",[e("th",{staticClass:"rounded-start"},[t._v("#")]),e("th",{attrs:{width:"40%"}},[t._v("Tên dịch vụ")]),e("th",{attrs:{width:"10%"}},[t._v("Đơn vị tính")]),e("th",{attrs:{width:"7%"}},[t._v("Số lượng")]),e("th",[t._v("Tiền trước thuế")]),e("th",[t._v("Tiền sau thuế")]),e("th",{staticClass:"rounded-end",attrs:{width:"10%"}})])])},function(){var t=this,e=t._self._c;return e("thead",{staticClass:"table-dark"},[e("tr",[e("th",{staticClass:"rounded-start"},[t._v("#")]),e("th",{attrs:{width:"45%"}},[t._v("Họ và tên")]),e("th",[t._v("Chức vụ")]),e("th",[t._v("SĐT")]),e("th",[t._v("Email")]),e("th",[t._v("Mã TB")]),e("th",{staticClass:"rounded-end",attrs:{width:"100"}})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"spinner-border",attrs:{role:"status"}},[e("span",{staticClass:"visually-hidden"},[t._v("Loading...")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-auto"},[e("label",{staticClass:"fw-bold"},[t._v("Tiền trước thuế:")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-auto"},[e("label",{staticClass:"fw-bold col-form-label"},[t._v("Tiền thuế:")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"col-auto"},[e("label",{staticClass:"fw-bold col-form-label"},[t._v("Thành tiền:")])])}],i=(a(560),a(1859)),r=a(8881),n=a(7150),c=function(){var t=this,e=t._self._c;return e("tr",[e("td",[t._v(t._s(t.index))]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.detail.detail_content,expression:"detail.detail_content"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.detail.detail_content},on:{input:function(e){e.target.composing||t.$set(t.detail,"detail_content",e.target.value)}}})]),e("td",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.detail.detail_quantity,expression:"detail.detail_quantity"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.detail.detail_quantity},on:{input:function(e){e.target.composing||t.$set(t.detail,"detail_quantity",e.target.value)}}})]),t._m(0),e("td",[t.detail.device.device_price>0?[e("input",{directives:[{name:"model",rawName:"v-model",value:t.detail.device.device_price,expression:"detail.device.device_price"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:t.detail.device.device_price},on:{input:function(e){e.target.composing||t.$set(t.detail.device,"device_price",e.target.value)}}})]:[e("input",{staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.detail.device.device_name}})]],2),e("td"),t._m(1)])},l=[function(){var t=this,e=t._self._c;return e("td",[e("input",{staticClass:"form-control",attrs:{type:"text",value:"1"}})])},function(){var t=this,e=t._self._c;return e("td",[e("button",{staticClass:"btn btn-sm btn-primary me-1"},[e("i",{staticClass:"fa-thin fa-pen-to-square"})]),e("button",{staticClass:"btn btn-sm btn-danger"},[e("i",{staticClass:"fa-thin fa-trash-can"})])])}],d={props:{detail:Array}},m=d,u=a(1001),p=(0,u.Z)(m,c,l,!1,null,null,null),h=p.exports,_=function(){var t=this,e=t._self._c;return e("tbody",[e("tr",[e("td",[t._v(t._s(t.index+1))]),e("td",[t._v(t._s(t.registration.reg_fullname))]),e("td",[t._v(t._s(t.registration.reg_position))]),e("td",[t._v(t._s(t.registration.reg_phone))]),e("td",[t._v(t._s(t.registration.reg_email))]),e("td",[t._v(t._s(t.registration.ma_tb))]),e("td",[e("button",{staticClass:"btn btn-primary-soft btn-sm",on:{click:function(e){return t.sendRegistration(t.registration,t.index)}}},[e("i",{staticClass:"fa-thin fa-pen-to-square"})]),e("button",{staticClass:"btn btn-danger-soft btn-sm ms-1",on:{click:function(e){return t.deleteRegistration(t.registration,t.index)}}},[e("i",{staticClass:"fa-thin fa-trash-can"})])])])])},v=[],g={props:{registration:Object,index:Number},methods:{sendRegistration(t,e){this.$emit("sendRegistration",t,e)},deleteRegistration(t,e){this.$emit("deleteRegistration",t,e)}}},C=g,f=(0,u.Z)(C,_,v,!1,null,null,null),b=f.exports,y=function(){var t=this,e=t._self._c;return e("b-modal",{ref:"modalDetail",attrs:{id:"bv-modal-example","hide-header-close":"","no-close-on-backdrop":"","no-fade":"",size:"lg","ignore-enforce-focus-selector":"span.select2-container"},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v("Thêm dịch vụ ")]},proxy:!0},{key:"modal-footer",fn:function(){return[e("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveDetail}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return t.$bvModal.hide("bv-modal-example")}}},[e("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[e("b-row",[e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Nhóm dịch vụ")]),e("select2",{attrs:{options:t.selects.categories,settings:t.settings},model:{value:t.Detail.cate_id,callback:function(e){t.$set(t.Detail,"cate_id",e)},expression:"Detail.cate_id"}})],1)]),e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Dịch vụ")]),e("select2",{attrs:{options:t.product,settings:t.settings},on:{change:function(e){return t.getProduct()}},model:{value:t.Detail.product_id,callback:function(e){t.$set(t.Detail,"product_id",e)},expression:"Detail.product_id"}})],1)])],1),e("b-row",[e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Tiền trước thuế")]),e("money",t._b({staticClass:"form-control",model:{value:t.Detail.detail_product_price,callback:function(e){t.$set(t.Detail,"detail_product_price",e)},expression:"Detail.detail_product_price"}},"money",t.money,!1))],1)]),e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Mã thuê bao")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Detail.ma_tb,expression:"Detail.ma_tb"}],staticClass:"form-control",attrs:{placeholder:"Mã thuê bao",type:"text"},domProps:{value:t.Detail.ma_tb},on:{input:function(e){e.target.composing||t.$set(t.Detail,"ma_tb",e.target.value)}}})])])],1),e("b-row",[e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Mã BHXH/Số lượng hóa đơn")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Detail.extra1,expression:"Detail.extra1"}],staticClass:"form-control",attrs:{placeholder:"Mã BHXH/Số lượng hóa đơn",type:"text"},domProps:{value:t.Detail.extra1},on:{input:function(e){e.target.composing||t.$set(t.Detail,"extra1",e.target.value)}}})])]),e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ký hiệu/Mẫu số")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.Detail.extra2,expression:"Detail.extra2"}],staticClass:"form-control",attrs:{placeholder:"Ký hiệu/Mẫu số",type:"text"},domProps:{value:t.Detail.extra2},on:{input:function(e){e.target.composing||t.$set(t.Detail,"extra2",e.target.value)}}})])])],1),e("b-row",{staticClass:"mt-1"},[e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-check form-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.Detail.is_device,expression:"Detail.is_device"}],staticClass:"form-check-input",attrs:{type:"checkbox",role:"switch"},domProps:{checked:Array.isArray(t.Detail.is_device)?t._i(t.Detail.is_device,null)>-1:t.Detail.is_device},on:{change:function(e){var a=t.Detail.is_device,s=e.target,o=!!s.checked;if(Array.isArray(a)){var i=null,r=t._i(a,i);s.checked?r<0&&t.$set(t.Detail,"is_device",a.concat([i])):r>-1&&t.$set(t.Detail,"is_device",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.Detail,"is_device",o)}}}),e("label",{staticClass:"form-check-label",attrs:{for:"flexSwitchCheckChecked"}},[t._v("Thiết bị")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.Detail.is_device,expression:"Detail.is_device"}]})]),e("b-col",{attrs:{cols:"6"}},[e("div",{staticClass:"form-check form-switch"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.Detail.is_payment,expression:"Detail.is_payment"}],staticClass:"form-check-input",attrs:{type:"checkbox",role:"switch"},domProps:{checked:Array.isArray(t.Detail.is_payment)?t._i(t.Detail.is_payment,null)>-1:t.Detail.is_payment},on:{change:function(e){var a=t.Detail.is_payment,s=e.target,o=!!s.checked;if(Array.isArray(a)){var i=null,r=t._i(a,i);s.checked?r<0&&t.$set(t.Detail,"is_payment",a.concat([i])):r>-1&&t.$set(t.Detail,"is_payment",a.slice(0,r).concat(a.slice(r+1)))}else t.$set(t.Detail,"is_payment",o)}}}),e("label",{staticClass:"form-check-label",attrs:{for:"flexSwitchCheckChecked"}},[t._v("Tính tiền")])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.Detail.is_payment,expression:"Detail.is_payment"}]})])],1),e("b-row",[e("b-col",{staticClass:"12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Nội dung")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Detail.detail_content,expression:"Detail.detail_content"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nội dung","data-bs-toggle":"dropdown",rows:"1"},domProps:{value:t.Detail.detail_content},on:{click:function(e){t.autoComplete.isShow=!0},keydown:t.changeDetail,input:function(e){e.target.composing||t.$set(t.Detail,"detail_content",e.target.value)}}}),t._v(" "),e("ul",{staticClass:"dropdown-menu bg-blur"},[t._l(t.filterItem,(function(a){return e("li",{key:a,on:{click:function(e){return t.setItem(a)}}},[e("a",{staticClass:"dropdown-item hand",attrs:{title:a}},[t._v(t._s(a))])])})),0==t.filterItem.length?e("li",[e("div",{staticClass:"text-danger text-center"},[t._v("Không có dữ liệu")])]):t._e()],2)])])],1),e("b-row",[e("b-col",{staticClass:"12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ghi chú")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.Detail.detail_note,expression:"Detail.detail_note"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ghi chú",rows:"3"},domProps:{value:t.Detail.detail_note},on:{input:function(e){e.target.composing||t.$set(t.Detail,"detail_note",e.target.value)}}})])])],1)],1)},x=[],w=a(4838),D=a(1427),k={components:{Select2:r.Z,Money:w.Money},data(){return{Detail:{cate_id:0,product_id:0,detail_product_price:0,detail_product_component:0,detail_content:"",detail_unit:"Cái",detail_quantity:1,is_device:!1,extra1:"",extra2:"",detail_note:null,is_payment:1},autoComplete:{items:["Dịch vụ chữ ký số công cộng VNPT-CA ({key})","HD{key} ({key} hóa đơn)","Chứng từ thuế thu nhập cá nhân HD{key} ({key} chứng từ)","Dịch vụ kê khai BHXH VNPT-BHXH ({key})","Gia hạn dịch vụ giám sát thành trình VNPT-TRACKING ({key})","Gói cước dịch vụ VNPT-CA trên sim Vinaphone ({key})","Dịch vụ chữ ký số công cộng VNPT-CA tích hợp VNPT-BHXH ({key})"],isShow:!1},selects:{categories:[],products:[],devices:[]},settings:{placeholder:"--Hãy chọn dữ liệu--",theme:"bootstrap-5",width:"100%"},isUpdate:!1,index:0,productName:"",money:{decimal:",",thousands:".",prefix:"",suffix:" ",precision:4,masked:!1}}},computed:{...(0,D.Se)("products",["products"]),...(0,D.Se)("categories",["categories"]),product(){return this.selects.products.filter((t=>t.cate_id==this.Detail.cate_id))},filterItem(){return this.autoComplete.isShow=!0,this.autoComplete.items.filter((t=>{if(this.Detail.detail_content)return-1!==t.toLowerCase().indexOf(this.Detail.detail_content.toLowerCase())}))}},mounted(){},methods:{changeDetail(){return this.autoComplete.isShow=!0,this.autoComplete.items.filter((t=>{if(this.Detail.detail_content)return-1!==t.toLowerCase().indexOf(this.Detail.detail_content.toLowerCase())}))},saveDetail(){const t=this.product.find((t=>t.id==this.Detail.product_id));if(!t)return void this.$toast.warning("Sản phẩm không tồn tại");this.Detail.detail_unit=this.Detail.is_device?"Cái":"Gói";const e=this.getCategory(t.cate_id),a=e?e.text:"";0==this.Detail.detail_content.length&&(this.Detail.detail_content=this.Detail.is_device?a:`${a} ${t.text}`);const s=this.Detail.cate_id>0&&this.Detail.product_id>0;s?(this.Detail["product"]=t,this.$emit("saveDetail",this.Detail,this.isUpdate,this.index),this.$bvModal.hide("bv-modal-example")):this.$toast.warning("Bạn chưa chọn dịch vụ")},setItem(t){this.Detail.detail_content=t.replace(/\{key\}/g,""),this.autoComplete.isShow=!1},onModalHide(){},show(t=[],e=0){t.cate_id>0?(this.index=e,this.isUpdate=!0,this.Detail={...t}):(this.Detail={cate_id:0,product_id:0,detail_product_price:0,detail_product_component:0,is_device:!1,is_payment:!0},this.isUpdate=!1),this.getCategories(),this.getProducts(),this.$bvModal.show("bv-modal-example")},getProduct(){let t=this.product.filter((t=>t.id==this.Detail.product_id))[0];const e=this.getCategory(t.cate_id),a=e?e.text:"";this.Detail.detail_product_price=t.product_price,this.Detail.detail_product_component=t.product_component_price,this.Detail.product_id=t.id,this.Detail.detail_content=this.Detail.is_device?a:`${a}`,this.Detail.detail_quantity=1},getCategory(t){return this.selects.categories.filter((e=>e.id==t))[0]},async getCategories(){await this.$store.dispatch("categories/getCategories"),this.selects.categories=this.categories.map((t=>({id:t.cate_id,text:t.cate_name})))},async getProducts(){await this.$store.dispatch("products/getProducts"),this.selects.products=this.products.map((t=>({id:t.product_id,text:t.product_name,cate_id:t.cate_id,product_price:t.product_price,product_component_price:t.product_component_price})))}}},$=k,T=(0,u.Z)($,y,x,!1,null,"ded7003e",null),N=T.exports,S=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"modalTemplate",title:"Danh sách mẫu hợp đồng","hide-header-close":"","no-close-on-backdrop":"","no-fade":""},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[e("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveTemplate}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return t.$bvModal.hide("modalTemplate")}}},[e("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[e("div",{staticClass:"row mb-1"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nhập từ khóa để tìm kiếm..."},domProps:{value:t.keyword},on:{input:function(e){e.target.composing||(t.keyword=e.target.value)}}})])])]),e("div",{staticClass:"card border-0"},[e("div",{staticClass:"card-body p-0 overflow-auto",staticStyle:{height:"400px"}},[e("ul",{staticClass:"list-group"},t._l(t.templateSearch,(function(a){return e("li",{key:a.temp_id,staticClass:"list-group-item"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.templateSelected,expression:"templateSelected"}],staticClass:"form-check-input me-1",attrs:{type:"checkbox",id:a.temp_id},domProps:{value:a.temp_id,checked:Array.isArray(t.templateSelected)?t._i(t.templateSelected,a.temp_id)>-1:t.templateSelected},on:{change:function(e){var s=t.templateSelected,o=e.target,i=!!o.checked;if(Array.isArray(s)){var r=a.temp_id,n=t._i(s,r);o.checked?n<0&&(t.templateSelected=s.concat([r])):n>-1&&(t.templateSelected=s.slice(0,n).concat(s.slice(n+1)))}else t.templateSelected=i}}}),e("label",{staticClass:"form-check-label",attrs:{for:a.temp_id}},[t._v(t._s(a.temp_name))])])})),0)])])])},M=[],P={props:{templateSelecteds:Array},data(){return{keyword:"",templateSelected:[]}},computed:{...(0,D.Se)("templates",["templates"]),templateSearch(){return this.templates.filter((t=>-1!==t.temp_name.toLowerCase().indexOf(this.keyword.toLowerCase())))}},created(){this.templateSelected=this.templateSelecteds},methods:{saveTemplate(){this.templateSelected.length>0&&(this.$emit("saveTemplate",this.templateSelected),this.$toast.success("Thêm mẫu thành công")),this.$bvModal.hide("modalTemplate")},async getTemplates(){this.$econtract.showLoading(),await this.$store.dispatch("templates/getTemplates"),console.log(this.templates),this.$econtract.hideLoading()},show(){this.getTemplates(),this.$bvModal.show("modalTemplate")}}},R=P,H=(0,u.Z)(R,S,M,!1,null,null,null),O=H.exports,L=function(){var t=this,e=t._self._c;return e("b-modal",{ref:"modalDetail",attrs:{id:"registration","hide-header-close":"","no-close-on-backdrop":"","no-fade":"",size:"lg"},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v("Thêm phiếu đăng ký")]},proxy:!0},{key:"modal-footer",fn:function(){return[e("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveRegistration}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),e("button",{staticClass:"btn btn-secondary",on:{click:function(e){return t.$bvModal.hide("registration")}}},[e("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Họ và tên")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.reg_fullname,expression:"regiation.reg_fullname"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Họ và tên"},domProps:{value:t.regiation.reg_fullname},on:{input:function(e){e.target.composing||t.$set(t.regiation,"reg_fullname",e.target.value)}}})])]),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Chức vụ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.reg_position,expression:"regiation.reg_position"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Chức vụ"},domProps:{value:t.regiation.reg_position},on:{input:function(e){e.target.composing||t.$set(t.regiation,"reg_position",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.reg_email,expression:"regiation.reg_email"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Email"},domProps:{value:t.regiation.reg_email},on:{input:function(e){e.target.composing||t.$set(t.regiation,"reg_email",e.target.value)}}})])]),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Số điện thoại")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.reg_phone,expression:"regiation.reg_phone"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Số điện thoại",maxlength:"15"},domProps:{value:t.regiation.reg_phone},on:{input:function(e){e.target.composing||t.$set(t.regiation,"reg_phone",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("CMND/CCCD")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.card_id,expression:"regiation.card_id"}],staticClass:"form-control",attrs:{type:"text",placeholder:"CMND/CCCD"},domProps:{value:t.regiation.card_id},on:{input:function(e){e.target.composing||t.$set(t.regiation,"card_id",e.target.value)}}})])]),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ngày cấp CCCD/CMND")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.card_date_create,expression:"regiation.card_date_create"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ngày cấp CCCD/CMND"},domProps:{value:t.regiation.card_date_create},on:{input:function(e){e.target.composing||t.$set(t.regiation,"card_date_create",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Nơi cấp CMND/CCCD")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.card_issued,expression:"regiation.card_issued"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nơi cấp CMND/CCCD"},domProps:{value:t.regiation.card_issued},on:{input:function(e){e.target.composing||t.$set(t.regiation,"card_issued",e.target.value)}}})])]),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Mã đăng ký")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.regiation.ma_tb,expression:"regiation.ma_tb"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Mã đăng ký"},domProps:{value:t.regiation.ma_tb},on:{input:function(e){e.target.composing||t.$set(t.regiation,"ma_tb",e.target.value)}}})])])])])},A=[],Y={data(){return{regiation:{reg_id:0,reg_fullname:"",reg_email:"",contract_id:0,card_id:"",card_date_create:"",card_issued:"",reg_phone:0,reg_position:"",ma_tb:""},isUpdate:!1,index:0}},methods:{show(t=[],e=0){null!=t.reg_fullname?(this.regiation={...t},this.index=e,this.isUpdate=!0):(this.regiation={reg_id:0,reg_fullname:"",reg_email:"",contract_id:0,card_id:"",card_date_create:"",card_issued:"",reg_phone:0,reg_position:"",ma_tb:""},this.isUpdate=!1),this.$bvModal.show("registration")},async saveRegistration(){this.checkValidate()?(delete this.regiation.pivot,this.isUpdate?await i.Z.put(`registration/${this.regiation.reg_id}`,this.regiation).then((t=>{this.$emit("saveRegistration",t.data,this.isUpdate,this.index),this.$bvModal.hide("registration")})):await i.Z.post("registration",this.regiation).then((t=>{this.$emit("saveRegistration",t.data,this.isUpdate,this.index),this.$bvModal.hide("registration")}))):this.$toast.warning("Chưa nhập đủ dữ liệu")},checkValidate(){return""!=this.regiation.reg_fullname}}},Z=Y,K=(0,u.Z)(Z,L,A,!1,null,null,null),V=K.exports,z=a(7096),U=a(4132),B=a(8915),q=a.n(B),X=a(9773),G=a.n(X),I=a(3669),E=function(){var t=this,e=t._self._c;return t.isShow?e("b-modal",{attrs:{id:"modalRegistrationsList",title:"Danh sách phiếu đăng ký","no-fade":"",size:"xl","hide-footer":""}},[e("div",{staticClass:"form-group mb-1"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tìm kiếm tên phiếu đăng ký"},domProps:{value:t.keyword},on:{input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]),e("div",{staticClass:"card p-0 border-0"},[e("div",{staticClass:"card-body overflow-auto",staticStyle:{height:"400px"}},[e("table",{staticClass:"table"},[e("thead",{staticClass:"table-dark"},[e("tr",[e("th",{staticClass:"rounded-start",attrs:{scope:"col"}},[t._v("#")]),e("th",{attrs:{width:"25%"}},[t._v("Họ và tên")]),e("th",[t._v("SĐT")]),e("th",{staticClass:"text-wrap",attrs:{width:"5%"}},[t._v("Mã TB")]),e("th",[t._v("Tên HĐ")]),e("th",{staticClass:"rounded-end"})])]),e("tbody",t._l(t.filterdRegistrations,(function(a){return e("tr",{key:a.reg_id},[e("td",[t._v(t._s(a.reg_id))]),e("td",[e("strong",{staticClass:"text-primary"},[t._v(t._s(a.reg_fullname))])]),e("td",[t._v(t._s(a.reg_phone))]),e("td",[t._v(t._s(a.ma_tb))]),e("td",[a.contracts?[e("small",[t._v(" "+t._s(a.contracts.company.company_name)+" ")])]:t._e()],2),e("td",[e("button",{staticClass:"btn btn-primary-soft btn-sm",on:{click:function(e){return t.choose(a)}}},[e("i",{staticClass:"fa-regular fa-circle-arrow-right"})])])])})),0)])])])]):t._e()},j=[],F={data(){return{isShow:!0,registrations:[],keyword:""}},created(){},computed:{filterdRegistrations(){return this.registrations.filter((t=>-1!==t.reg_fullname.toLowerCase().indexOf(this.keyword.toLowerCase())))}},methods:{choose(t){this.$emit("reviceRegistration",t),this.$bvModal.hide("modalRegistrationsList")},show(){this.isShow=!0,this.getRegistrations(),this.$bvModal.show("modalRegistrationsList")},async getRegistrations(){this.$econtract.showLoading(),await i.Z.get("registration").then((t=>{this.registrations=t.data,this.$econtract.hideLoading()}))}}},Q=F,J=(0,u.Z)(Q,E,j,!1,null,null,null),W=J.exports,tt=a(2847),et=function(){var t=this,e=t._self._c;return e("b-modal",{attrs:{id:"modal-contract-option","hide-header-close":"","no-close-on-backdrop":"","no-fade":"",size:"lg",title:"Tùy chỉnh thông tin hợp đồng"},scopedSlots:t._u([{key:"modal-footer",fn:function(){return[e("button",{staticClass:"btn btn-primary-soft",on:{click:t.store}},[e("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")]),e("button",{staticClass:"btn btn-secondary",on:{click:t.close}},[e("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Người đại diện")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ContractOption.owner_name,expression:"ContractOption.owner_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Tên người đại  diện"},domProps:{value:t.ContractOption.owner_name},on:{input:function(e){e.target.composing||t.$set(t.ContractOption,"owner_name",e.target.value)}}})])]),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Chức vụ")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ContractOption.owner_position,expression:"ContractOption.owner_position"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Chức vụ đại  diện"},domProps:{value:t.ContractOption.owner_position},on:{input:function(e){e.target.composing||t.$set(t.ContractOption,"owner_position",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Số CCCD")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ContractOption.owner_card_id,expression:"ContractOption.owner_card_id"}],staticClass:"form-control",attrs:{type:"text",placeholder:"CCCD/CMND Người đại diện"},domProps:{value:t.ContractOption.owner_card_id},on:{input:function(e){e.target.composing||t.$set(t.ContractOption,"owner_card_id",e.target.value)}}})])]),e("div",{staticClass:"col-6"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Ngày Cấp")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ContractOption.owner_card_date,expression:"ContractOption.owner_card_date"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ngày cấp"},domProps:{value:t.ContractOption.owner_card_date},on:{input:function(e){e.target.composing||t.$set(t.ContractOption,"owner_card_date",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Nơi cấp")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ContractOption.owner_card_issuedby,expression:"ContractOption.owner_card_issuedby"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Nơi cấp CCCD"},domProps:{value:t.ContractOption.owner_card_issuedby},on:{input:function(e){e.target.composing||t.$set(t.ContractOption,"owner_card_issuedby",e.target.value)}}})])])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12"},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:""}},[t._v("Giấy ủy quyền số:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.ContractOption.owner_authority,expression:"ContractOption.owner_authority"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Giấy ủy quyền số:"},domProps:{value:t.ContractOption.owner_authority},on:{input:function(e){e.target.composing||t.$set(t.ContractOption,"owner_authority",e.target.value)}}})])])])])},at=[],st={data(){return{ContractOption:{owner_name:"",owner_position:"",owner_authority:"",contract_id:0,owner_card_issuedby:"",owner_card_date:G()().format("DD/MM/YYYY"),owner_card_id:0}}},methods:{store(){this.$emit("updateContractOption",this.ContractOption),this.close()},show(){this.$bvModal.show("modal-contract-option")},close(){this.$bvModal.hide("modal-contract-option")}}},ot=st,it=(0,u.Z)(ot,et,at,!1,null,null,null),rt=it.exports,nt={components:{Select2:r.Z,contractDetail:n.Z,contractDevice:h,modelAddDetail:N,Money:w.Money,modalTemplates:O,modalRegistration:V,regDetail:b,modalCompanies:z.Z,modalCustomers:U.Z,notFound:tt.Z,datePicker:q(),ModalCustomerAdd:I.Z,ContractOptionModal:rt,ModalRegistrationList:W},data(){return{dateChoose:12,dateChooses:[{id:6,text:"06 tháng"},{id:12,text:"12 tháng"},{id:18,text:"18 tháng"},{id:24,text:"24 tháng"},{id:33,text:"33 tháng"},{id:36,text:"36 tháng"},{id:48,text:"48 tháng"},{id:130,text:"130 tháng (10 năm)"}],settings:{placeholder:"--Hãy chọn dữ liệu--",theme:"bootstrap-5"},options:{format:"DD/MM/YYYY",useCurrent:!1},money:{decimal:",",thousands:".",prefix:"",suffix:" ",precision:0,masked:!1},ratios:[],contract_id:0,isUpdate:!1,Contract:{company_id:0,company_name:"",contract_number:"",contract_number_pattern:"",contract_code:"",contract_date:this.$econtract.formatDate(new Date),contract_note:"",customer_id:0,customer_name:"",contract_type:0,contract_price_text:"",contract_date_create:G()(),contract_date_start:this.$econtract.formatDate(new Date),contract_date_end:this.$econtract.formatDate(new Date),contract_payment:0,contract_status:0,is_renew:!1,renew_date:G()(),contract_total:0,contract_tax:0,contract_area:0,subTotal:0,contract_expired_month:12,details:[],templates:[],registrations:[],ratio_id:0},selects:{companies:[],customers:[],contract_number_pattern_list:["TTKD VNPT-ST-KHDN/HĐCA","TTKD VNPT-ST-KHDN/HĐ HĐĐT","TTKD VNPT-ST-KHDN/HĐBHXH","TTKD VNPT-ST-KHDN/HĐ HKD","TTKD VNPT-ST-KHDN/HĐVANCA","TTKD VNPT-ST-KHDN/HĐCNTT"]},Price:{SubTotal:0,Tax:0,Total:0,DevicePrice:0,ComponentPrice:0},isLoadingTable:!1,templateSelected:[],debounceTimeout:null}},watch:{"Contract.contract_type":{handler:function(t){let e=parseInt(t);this.Contract.ratio_id=e+1}},"Contract.contract_total":{handler:function(t){this.Contract.contract_price_text=this.numberToVND(t)}},"Contract.contract_expired_month":{handler:function(t){this.changeDateChoose()}},"Contract.contract_date":{handler:function(t){this.Contract.contract_date_start=t,this.changeDateChoose()},deep:!0,immediate:!1},"Contract.details":{handler:function(t){let e=0,a=this.Contract.details.reduce(((t,a)=>(a.is_payment&&(e=t+a.detail_product_price*a.detail_quantity),e)),0);this.Contract.subTotal=a,this.Contract.contract_tax=.1*a,this.Contract.contract_total=Math.round(this.Contract.subTotal+this.Contract.contract_tax),this.Contract.contract_price_text=this.numberToVND(this.Contract.contract_total)},deep:!0,immediate:!1}},computed:{filteredDetails(){return this.Contract.details.filter((t=>1!==t.isDelete))},filteredRegistrations(){return this.Contract.registrations.filter((t=>1!==t.isDelete))}},created(){this.$route.params.id&&(this.isUpdate=!0,this.contract_id=this.$route.params.id,this.getDetail()),this.changeDateChoose(),this.getRatio(),this.Contract.ratio_id=1},activated(){this.fet},methods:{reviceRegistration(t){this.Contract.registrations.push(t),this.$toast.success("Thêm dữ liệu thành công")},chooseRegistration(){this.$refs.registrationList.show()},updateContractOption(t){this.Contract.option.owner_name="ac"},showContractOptionModal(){this.$refs.contractoption.show()},addCustomerSuccess(t){this.Contract.customer_id=t.customer_id,this.Contract.customer_name=t.customer_name},addCustomer(){this.$refs.modalcustomeradd.show()},changeDateChoose(){let t=G()(this.Contract.contract_date_start,"DD/MM/YYYY"),e=G()(t,"DD/MM/YYYY"),a=G()(e).add(this.Contract.contract_expired_month,"months");this.Contract.contract_date_end=a.format("DD/MM/YYYY")},chooseCustomer(t){let e=0!=t.customer_phone?t.customer_phone:"Chưa có số liên hệ";this.Contract.customer_name=t.customer_name+" - SĐT: "+e,this.Contract.customer_id=t.customer_id},openModalCustomer(){this.$refs.modalcustomers.show()},chooseCompany(t){this.Contract.company_id=t.company_id,this.Contract.company_name=t.company_name+" - MST: "+t.company_taxcode},openModalCompany(){this.$refs.modalcompanies.show()},saveRegistration(t,e,a){e?(Object.assign(this.Contract.registrations[a],t),this.$toast.success("Cập nhật thuê bao thành công")):(this.Contract.registrations.push({...t,contract_id:this.Contract.contract_id}),this.$toast.success("Thêm thuê bao thành công"))},addRegistration(){this.$refs.modalRegistration.show()},saveTemplate(t){this.templateSelected=t},addTemplates(){this.$refs.modalTemplate.show()},sendRegistration(t,e){this.$refs.modalRegistration.show(t,e)},sendDetail(t,e){this.$refs.modalDetail.show(t,e)},saveDetail(t,e,a){e?(Object.assign(this.Contract.details[a],t),this.$toast.success("Cập nhật thuê bao thành công")):(this.Contract.details.push({...t,detail_id:0,contract_id:this.Contract.contract_id,detail_note:void 0==typeof t.detail_note?null:t.detail_note,detail_device_price:0}),this.$toast.success("Thêm thuê bao thành công"))},addDetail(){this.$refs.modalDetail.show()},async store(){if(0==this.Contract.contract_number.length)return this.$toast.warning("Chưa nhập số hợp đồng"),!1;delete this.Contract.company_name,delete this.Contract.customer_name,0==this.templateSelected.length&&this.$toast.warning("Bạn chưa chọn mẫu hợp đồng"),this.$econtract.showLoading(),this.Contract.templates=this.templateSelected;try{let t;t=this.isUpdate?await i.Z.put("/contracts/update",this.Contract):await i.Z.post("/contracts/store",this.Contract),200==t.status&&(this.$toast.success(t.data.msg),this.$router.push({name:"contract-index"}))}catch(t){this.$toast.error("Có lỗi xảy ra khi tạo mới hợp đồng")}finally{this.$econtract.hideLoading()}},validate(){if(0==this.Contract.contract_number.length)return this.$toast.warning("Chưa nhập số hợp đồng"),!1},changeSubTotal(){this.Contract.subTotal=this.Contract.subTotal},changeTax(){this.Contract.contract_total=Math.round(this.Contract.subTotal+this.Contract.contract_tax)},deleteDetail(t,e){this.$confirm({title:"Xác nhận xóa",message:"Bạn có muốn xóa dòng này không?",button:{yes:"Yes",no:"Cancel"},callback:t=>{t&&(this.$set(this.Contract.details,e,{...this.Contract.details[e],isDelete:1}),this.$toast.success("Xóa dịch vụ thành công"))}})},deleteRegistration(t,e){this.$confirm({title:"Xác nhận xóa",message:"Bạn có muốn xóa dòng này không?",button:{yes:"Yes",no:"Cancel"},callback:t=>{t&&(this.$set(this.Contract.registrations,e,{...this.Contract.registrations[e],isDelete:1}),this.Contract.registrations.splice(e,1),this.$toast.success("Xóa dịch vụ thành công"))}})},formattedDate(t){return t},async getRatio(){await i.Z.get("/ratio").then((t=>{this.ratios=t.data}))},async getDetail(){clearTimeout(this.debounceTimeout),this.isLoadingTable=!0,this.$econtract.showLoading(),await i.Z.get(`/contracts/edit/${this.contract_id}`).then((t=>{500==t.data.status_code?(this.$toast.warning(t.data.msg),this.$router.push({name:"contract-index"})):(this.Contract=t.data,this.Contract.templates.map((t=>{this.templateSelected.push(t.temp_id)})),this.Contract.contract_date=this.$econtract.formatDate(this.Contract.contract_date),this.Contract.contract_date_start=this.$econtract.formatDate(this.Contract.contract_date_start),this.Contract.contract_date_end=this.$econtract.formatDate(this.Contract.contract_date_end),this.$econtract.hideLoading(),this.isLoadingTable=!1)}))},numberToVND(t){return this.$econtract.doc(t)}}},ct=nt,lt=(0,u.Z)(ct,s,o,!1,null,null,null),dt=lt.exports}}]);
//# sourceMappingURL=557.0ec92f62.js.map
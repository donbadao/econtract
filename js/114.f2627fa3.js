"use strict";(self["webpackChunkecontract_frontend"]=self["webpackChunkecontract_frontend"]||[]).push([[114],{276:function(t,a,e){e.d(a,{Z:function(){return m}});var s=function(){var t=this,a=t._self._c;return a("b-modal",{attrs:{id:"modal-complete-Contract","hide-header-close":"","no-close-on-backdrop":"",size:"md"},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(t._s(t.title)+" ")]},proxy:!0},{key:"modal-footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary",on:{click:function(a){return t.$bvModal.hide("modal-complete-Contract")}}},[a("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")]),a("button",{staticClass:"btn btn-primary-soft",on:{click:t.saveComplete}},[a("i",{staticClass:"fa-thin fa-floppy-disk"}),t._v(" Lưu ")])]},proxy:!0}])},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Tên công ty")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.Contract.company_name,expression:"Contract.company_name"}],staticClass:"form-control",attrs:{type:"text",disabled:""},domProps:{value:t.Contract.company_name},on:{input:function(a){a.target.composing||t.$set(t.Contract,"company_name",a.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Ngày hoàn hiện")]),a("date-picker",{attrs:{config:t.options},model:{value:t.Contract.complete_date,callback:function(a){t.$set(t.Contract,"complete_date",a)},expression:"Contract.complete_date"}})],1),1==t.type?a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Trạng thái thanh toán")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.payment_status,expression:"payment_status"}],staticClass:"form-select",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.payment_status=a.target.multiple?e:e[0]}}},[a("option",{attrs:{value:"3"}},[t._v("Đã nộp tiền")]),a("option",{attrs:{value:"4"}},[t._v("Đã nộp tiền và làm thanh toán")])])]):t._e()])},n=[],c=e(9773),r=e.n(c),o=e(8915),i=e.n(o),l=e(1859),d={components:{datePicker:i()},data(){return{options:{format:"DD/MM/YYYY",useCurrent:!1},Contract:[],type:0,title:"Hoàn thiện hợp đồng",payment_status:3}},methods:{show(t=null,a=0){this.title=0==a?"Hoàn thiện hợp đồng":"Thanh toán hợp đồng",this.Contract=t,this.type=a,this.Contract.complete_date=r()(),this.$bvModal.show("modal-complete-Contract")},async saveComplete(){await l.Z.put("/contracts/updatestatus",{type:this.type,payment_status:this.payment_status,contract_id:this.Contract.contract_id,complete_date:r()(this.Contract.complete_date).format("YYYY-MM-DD HH:mm:ss")}).then((t=>{"success"==t.data.message&&(this.$toast.success("Cập nhật dữ liệu thành công"),this.$emit("updateCompleteContract",t.data.data))})),this.$bvModal.hide("modal-complete-Contract")}}},u=d,h=e(1001),p=(0,h.Z)(u,s,n,!1,null,null,null),m=p.exports},2847:function(t,a,e){e.d(a,{Z:function(){return i}});var s=function(){var t=this,a=t._self._c;return a("div",{staticClass:"col flex-column text-center"},[a("svg",{attrs:{width:"100",height:"100"}},[a("svg",{attrs:{id:"Layer_1","data-name":"Layer 1",viewBox:"0 0 208 230"}},[a("defs",[a("linearGradient",{attrs:{id:"colorNodata",x1:"133.69",y1:"120.61",x2:"73.06",y2:"91.22",gradientTransform:"matrix(1, 0, 0, -1, 0, 231.28)",gradientUnits:"userSpaceOnUse"}},[a("stop",{attrs:{offset:"0","stop-color":"#95abc2"}}),a("stop",{attrs:{offset:"1","stop-color":"#fff"}})],1),a("mask",{attrs:{id:"maskColorNodata",x:"134.5",y:"14.55",width:"17.97",height:"17.21",maskUnits:"userSpaceOnUse"}},[a("g",{attrs:{id:"handFlag"}},[a("path",{attrs:{d:"M137,24a8.1,8.1,0,0,1,8.1-8.1h6.3v6.3a8.1,8.1,0,0,1-8.1,8.1H137Z",fill:"#fff"}})])])],1),a("path",{attrs:{d:"M94.2,85.7l85.9,23.6v82.6l-85.9-37Z",fill:"#8e99a3"}}),a("path",{attrs:{d:"M94.3,85.7,24.1,105.3v86.8l70.1-37.6Z",fill:"#a0aab5"}}),a("path",{attrs:{d:"M139.4,185.9c-19.4-5.7-53.4-5.2-66.2-38.3-11.7-30.4,31.5-59.6,43.6-46.8,8.6,9.1-2.4,22.2-17.7,20.7C82,119.8,71.9,104.5,75.3,88c6.7-32.7,58.3-54.4,60.5-55.9",fill:"none","stroke-width":"3","stroke-dasharray":"6 7",stroke:"url(#colorNodata)"}}),a("path",{attrs:{d:"M141,21.5s-.5-12.3-3.7-15.6a8.4,8.4,0,0,0-11.8,11.8C128.7,21,141,21.5,141,21.5Z",fill:"#ced8e5",opacity:"0.4"}}),a("path",{attrs:{d:"M146.7,26.4s.5,12.3,3.7,15.6a8.4,8.4,0,0,0,11.8-11.8C159.1,26.9,146.7,26.4,146.7,26.4Z",fill:"#ced8e5",opacity:"0.4"}}),a("path",{attrs:{d:"M137,24a8.1,8.1,0,0,1,8.1-8.1h6.3v6.3a8.1,8.1,0,0,1-8.1,8.1H137Z",fill:"#a8b7c5"}}),a("g",{attrs:{mask:"url(#maskColorNodata)"}},[a("rect",{attrs:{x:"140.1",y:"16.7",width:"2.3",height:"16.69",transform:"translate(23.6 107.2) rotate(-45)",fill:"#dde5f2"}}),a("path",{attrs:{d:"M139.1,16.2l1.6-1.6,11.8,11.8L150.9,28Z",fill:"#dde5f2"}})]),a("path",{attrs:{d:"M159.2,12.3l5.5-1.3",fill:"none",stroke:"#8696c5","stroke-width":"0.9"}}),a("path",{attrs:{d:"M156.9,10.1l2.1-5.5",fill:"none",stroke:"#8696c5","stroke-width":"0.9"}}),a("path",{attrs:{d:"M153.7,20.5a6.1,6.1,0,1,0-6.1-6.1A6.1,6.1,0,0,0,153.7,20.5Z",fill:"#8b9aa8"}}),a("path",{attrs:{d:"M24.1,105.5,110,132.8V229L24.1,192Z",fill:"#dae2ec"}}),a("path",{attrs:{d:"M180.5,109.2l-71.7,23.6V229l71.7-37Z",fill:"#c5d0d9"}}),a("path",{attrs:{d:"M180.3,109.1,208,146.2l-73.6,29L109,132.6Z",fill:"#dae2ec"}}),a("path",{attrs:{d:"M24,105.3,0,142.8l84.6,32.4,24.7-42.7Z",fill:"#c5d0d9"}})])]),a("h4",{staticClass:"text-center font-size-20px mb-2 text-no--data text-primary"},[t._v("Chưa có dữ liệu")]),a("div",{staticClass:"text-muted"},[t._v("Hãy thêm dữ liệu hoặc Kiểm tra lại thông tin tra cứu")])])},n=[],c=e(1001),r={},o=(0,c.Z)(r,s,n,!1,null,null,null),i=o.exports},438:function(t,a,e){e.d(a,{Z:function(){return l}});var s=function(){var t=this,a=t._self._c;return a("div",[a("nav",{attrs:{"aria-label":"Page navigation"}},[a("ul",{staticClass:"d-flex pagination justify-content-center mt-2"},[t.pagination.current_page>1?a("li",{staticClass:"page-item"},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(a){return a.preventDefault(),t.changePage(t.pagination.current_page-1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])]):t._e(),t._l(t.pagesNumber,(function(e){return a("li",{key:e,staticClass:"page-item",class:{active:e==t.pagination.current_page}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.changePage(e)}}},[t._v(t._s(e))])])})),a("li",{staticClass:"page-item"},[t.pagination.current_page<t.pagination.last_page?a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(a){return a.preventDefault(),t.changePage(t.pagination.current_page+1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])]):t._e()])],2)])])},n=[],c=(e(560),{props:{pagination:{type:Object,required:!0},offset:{type:Number,default:4}},computed:{pagesNumber:function(){if(!this.pagination.to)return[];var t=this.pagination.current_page-this.offset;t<1&&(t=1);var a=t+2*this.offset;a>=this.pagination.last_page&&(a=this.pagination.last_page);var e=[];for(t=1;t<=a;t++)e.push(t);return e}},methods:{changePage:function(t){this.pagination.current_page=t}}}),r=c,o=e(1001),i=(0,o.Z)(r,s,n,!1,null,null,null),l=i.exports},6114:function(t,a,e){e.r(a),e.d(a,{default:function(){return Y}});var s=function(){var t=this,a=t._self._c;return a("div",{attrs:{id:"contracts"}},[a("h1",{staticClass:"fw-bold title-page",attrs:{title:"Danh sách hợp đồng"}},[t._v("Danh sách hợp đồng")]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"d-flex justify-content-between"},[a("div",{staticClass:"mb-2"},[a("div",{staticClass:"input-group"},[a("div",{staticClass:"dropdown"},[t._m(0),a("ul",{staticClass:"dropdown-menu"},[a("li",[a("div",{staticClass:"dropdown-item"},[a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.company_name,expression:"searchBy.company_name"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"flexCheckDefault"},domProps:{value:t.searchBy.company_name,checked:Array.isArray(t.searchBy.company_name)?t._i(t.searchBy.company_name,t.searchBy.company_name)>-1:t.searchBy.company_name},on:{change:function(a){var e=t.searchBy.company_name,s=a.target,n=!!s.checked;if(Array.isArray(e)){var c=t.searchBy.company_name,r=t._i(e,c);s.checked?r<0&&t.$set(t.searchBy,"company_name",e.concat([c])):r>-1&&t.$set(t.searchBy,"company_name",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.searchBy,"company_name",n)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"flexCheckDefault"}},[t._v(" Tìm theo tên công ty ")])])])]),a("li",[a("div",{staticClass:"dropdown-item"},[a("div",{staticClass:"form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.taxcode,expression:"searchBy.taxcode"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"flexCheckDefault"},domProps:{value:t.searchBy.taxcode,checked:Array.isArray(t.searchBy.taxcode)?t._i(t.searchBy.taxcode,t.searchBy.taxcode)>-1:t.searchBy.taxcode},on:{change:function(a){var e=t.searchBy.taxcode,s=a.target,n=!!s.checked;if(Array.isArray(e)){var c=t.searchBy.taxcode,r=t._i(e,c);s.checked?r<0&&t.$set(t.searchBy,"taxcode",e.concat([c])):r>-1&&t.$set(t.searchBy,"taxcode",e.slice(0,r).concat(e.slice(r+1)))}else t.$set(t.searchBy,"taxcode",n)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"flexCheckDefault"}},[t._v(" Tìm theo mã số thuế công ty ")])])])]),a("li")])]),a("div",{staticClass:"position-relative d-inline-flex align-items-center"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],staticClass:"form-control",staticStyle:{"min-width":"400px"},attrs:{type:"text",placeholder:t.searchBy.placeholder,"aria-label":"Username","aria-describedby":"basic-addon1"},domProps:{value:t.keyword},on:{change:function(a){return t.search()},input:function(a){a.target.composing||(t.keyword=a.target.value)}}})]),a("div",{staticClass:"dropdown ms-1"},[t._m(1),a("ul",{staticClass:"dropdown-menu p-3",staticStyle:{width:"500px"}},[t._m(2),a("li",[a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Từ ngày")]),a("date-picker",{attrs:{config:t.options},model:{value:t.searchBy.startDate,callback:function(a){t.$set(t.searchBy,"startDate",a)},expression:"searchBy.startDate"}})],1)]),a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Đến ngày")]),a("date-picker",{attrs:{config:t.options},model:{value:t.searchBy.endDate,callback:function(a){t.$set(t.searchBy,"endDate",a)},expression:"searchBy.endDate"}})],1)])])])]),t._m(3),a("li",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Trạng thái hợp đồng")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.contract_status,expression:"searchBy.contract_status"}],staticClass:"form-select",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.searchBy,"contract_status",a.target.multiple?e:e[0])}}},[a("option",{attrs:{value:"-1"}},[t._v("Tất cả")]),a("option",{attrs:{value:"0"}},[t._v("Mới tạo lập")]),a("option",{attrs:{value:"1"}},[t._v("Đã trình ký")]),a("option",{attrs:{value:"2"}},[t._v("Đã gửi khách hàng")]),a("option",{attrs:{value:"3"}},[t._v("Hoàn thiện")]),a("option",{attrs:{value:"4"}},[t._v("Đã làm thanh toán")])])])]),a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Trạng thái thanh toán")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.payment_status,expression:"searchBy.payment_status"}],staticClass:"form-select",on:{change:function(a){var e=Array.prototype.filter.call(a.target.options,(function(t){return t.selected})).map((function(t){var a="_value"in t?t._value:t.value;return a}));t.$set(t.searchBy,"payment_status",a.target.multiple?e:e[0])}}},[a("option",{attrs:{value:"-1"}},[t._v("Tất cả")]),a("option",{attrs:{value:"0"}},[t._v("Chưa thanh toán")]),a("option",{attrs:{value:"1"}},[t._v("Đã nhận tiền nhưng chưa nộp tiền")]),a("option",{attrs:{value:"2"}},[t._v(" Đã nộp tiền nhưng chưa làm thanh toán ")]),a("option",{attrs:{value:"3"}},[t._v("Đã nộp tiền và xuất hóa đơn")])])])])])]),a("li",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-6"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:""}},[t._v("Mã HĐ/TT")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchBy.contract_code,expression:"searchBy.contract_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Mã hợp đồng"},domProps:{value:t.searchBy.contract_code},on:{input:function(a){a.target.composing||t.$set(t.searchBy,"contract_code",a.target.value)}}})])])])]),a("li",[a("button",{staticClass:"btn btn-primary-soft mt-2",on:{click:t.advanceSearch}},[a("i",{staticClass:"fa-solid fa-bars-filter"}),t._v(" Lọc ")]),a("button",{staticClass:"btn btn-secondary mt-2 ms-1",on:{click:t.search}},[a("i",{staticClass:"fa-regular fa-rotate"}),t._v(" Reset ")])])])])])]),a("div",{},[a("router-link",{staticClass:"btn btn-primary ms-2",attrs:{to:{name:"contract-create"}}},[a("i",{staticClass:"fa-duotone fa-circle-plus"}),t._v(" Tạo mới ")])],1)])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("tableContracts",{attrs:{contracts:t.contracts},on:{cancelContract:t.cancelContract}}),0==t.contracts.length?a("notFound"):t._e(),a("pagination",{attrs:{pagination:t.pagination,offset:4},nativeOn:{click:function(a){return t.fetchAll({page:t.pagination.current_page,name:t.keyword})}}})],1)])])},n=[function(){var t=this,a=t._self._c;return a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-bs-auto-close":"outside"}},[a("i",{staticClass:"fa-regular fa-gear"})])},function(){var t=this,a=t._self._c;return a("button",{staticClass:"btn btn-primary-soft",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false","data-bs-auto-close":"outside"}},[a("i",{staticClass:"fa-solid fa-bars-filter"}),t._v(" Lọc ")])},function(){var t=this,a=t._self._c;return a("li",[a("h5",{staticClass:"fw-bold"},[t._v("Tìm kiếm")])])},function(){var t=this,a=t._self._c;return a("li",[a("hr",{staticClass:"dropdown-divider"})])}],c=(e(560),e(438)),r=function(){var t=this,a=t._self._c;return a("div",{staticClass:"table-scroll"},[a("table",{staticClass:"table table-fixed-last-column"},[t._m(0),a("tbody",[t._l(t.contracts,(function(e,s){return[a("tr",{key:`parent-${e.contract_id}}`},[a("td",{attrs:{scope:"row"}},[a("button",{staticClass:"btn btn-default btn-xs",on:{click:function(a){return t.showDetail(e)}}},[a("i",{staticClass:"fa-regular fa-circle-info"})])]),a("td",[a("router-link",{attrs:{title:e.company_name,to:{name:"contract-edit",params:{id:e.contract_id}}}},[a("span",{staticClass:"text-capitalize"},[t._v(t._s(e.company_name))])]),e.contract_note?a("div",[a("i",{staticClass:"fa-regular fa-notes me-1"}),a("i",{staticClass:"text-danger fw-bold"},[t._v(" "+t._s(e.contract_note))])]):t._e()],1),a("td",[t._v(t._s(e.company_taxcode))]),a("td",[t._v(t._s(t._f("moment")(e.contract_date,"DD/MM/YYYY")))]),a("td",[1==e.contract_type?[t._m(1,!0)]:[t._m(2,!0)]],2),a("td",[e.contract_status<3?a("span",{staticClass:"text-danger",attrs:{title:"Chưa hoàn thiện"}},[a("i",{staticClass:"fa-regular fa-circle-xmark"})]):a("span",{staticClass:"text-success",attrs:{title:"Đã hoàn thiện "+e.complete_date}},[a("i",{staticClass:"fa-regular fa-circle-check"})])]),a("td",[t._v(" "+t._s(e.customer_name)+" ")]),a("td",{staticClass:"fixed-column"},[a("strong",{staticClass:"text-danger"},[t._v(t._s(t.formatAmout(e.contract_total))+"đ")])]),a("td",[a("div",{staticClass:"dropdown"},[t._m(3,!0),a("ul",{staticClass:"dropdown-menu"},[a("li",[a("router-link",{staticClass:"dropdown-item hand",attrs:{to:{name:"contract-detail",params:{id:e.contract_id}}}},[a("i",{staticClass:"fa-thin fa-circle-info"}),t._v(" Xem chi tiết ")])],1),a("li",[a("router-link",{staticClass:"dropdown-item",attrs:{to:{name:"contract-edit",params:{id:e.contract_id}}}},[a("i",{staticClass:"fa-thin fa-pen-to-square"}),t._v(" Cập nhật hợp đồng ")])],1),e.contract_status<3?a("li",[a("a",{staticClass:"dropdown-item hand",on:{click:function(a){return t.completeContract(e,0)}}},[a("i",{staticClass:"fa-thin fa-circle-check"}),t._v(" Hoàn thiện hợp đồng")])]):t._e(),e.contract_payment<3?a("li",[a("a",{staticClass:"dropdown-item hand",on:{click:function(a){return t.completeContract(e,1)}}},[a("i",{staticClass:"fa-thin fa-circle-dollar"}),t._v(" Thanh toán hợp đồng")])]):t._e(),a("li",[a("router-link",{staticClass:"dropdown-item hand",attrs:{title:"Tùy chỉnh hợp đồng",to:{name:"contract-option",params:{id:e.contract_id}}}},[a("i",{staticClass:"fa-thin fa-gear"}),t._v(" Tùy chỉnh hợp đồng ")])],1),e.templates.length>0?[t._m(4,!0),t._l(e.templates,(function(s){return a("li",{key:s.temp_id},[a("a",{staticClass:"dropdown-item hand text-primary fw-bold",attrs:{title:"Tải về "+s.temp_name},on:{click:function(a){return t.downloads(e.contract_id,s,e.company_taxcode)}}},[a("i",{staticClass:"fa-thin fa-cloud-arrow-down"}),t._v(" "+t._s(s.temp_name))])])}))]:t._e(),t._m(5,!0),a("li",[a("a",{staticClass:"dropdown-item hand",on:{click:function(a){return t.cancelContract(e,s)}}},[t._m(6,!0)])])],2)])])])]}))],2)]),a("completeContract",{ref:"completeContract",on:{updateCompleteContract:t.updateCompleteContract}}),a("contractDetail",{ref:"modalContractDetail"})],1)},o=[function(){var t=this,a=t._self._c;return a("thead",{staticClass:"table-dark"},[a("tr",[a("th",{staticClass:"rounded-start",attrs:{scope:"col"}},[t._v("#")]),a("th",[t._v("Tên công ty")]),a("th",[t._v("Mã số thuế")]),a("th",[t._v("Ngày HĐ")]),a("th",[t._v("Loại")]),a("th",[t._v("HT")]),a("th",{attrs:{scope:"col"}},[t._v("Đầu mối")]),a("th",{staticClass:"fixed-column"},[t._v("Tổng tiền (VAT)")]),a("th",{staticClass:"rounded-end",attrs:{scope:"col"}})])])},function(){var t=this,a=t._self._c;return a("span",{staticClass:"badge bg-warning bg-opacity-10 text-black"},[a("i",{staticClass:"fa-solid fa-circle-small"}),t._v(" Gia hạn")])},function(){var t=this,a=t._self._c;return a("span",{staticClass:"badge bg-success bg-opacity-10 text-success"},[a("i",{staticClass:"fa-solid fa-circle-small"}),t._v(" Mới")])},function(){var t=this,a=t._self._c;return a("button",{staticClass:"btn btn-sm border-0",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[a("i",{staticClass:"fa-solid fa-ellipsis-vertical"})])},function(){var t=this,a=t._self._c;return a("li",[a("hr",{staticClass:"dropdown-divider"})])},function(){var t=this,a=t._self._c;return a("li",[a("hr",{staticClass:"dropdown-divider"})])},function(){var t=this,a=t._self._c;return a("strong",{staticClass:"text-danger"},[a("i",{staticClass:"fa-thin fa-trash-can"}),t._v(" Hủy hợp đồng")])}],i=(e(8858),e(1318),e(3228),e(276)),l=function(){var t=this,a=t._self._c;return a("b-modal",{ref:"modal-add-delivery",attrs:{id:"modal-contract-detail","no-close-on-backdrop":"","no-fade":"",size:"lg","ignore-enforce-focus-selector":"span.select2-container"},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(t._s(t.title))]},proxy:!0},{key:"modal-footer",fn:function(){return[a("button",{staticClass:"btn btn-secondary",on:{click:t.close}},[a("i",{staticClass:"fa-thin fa-xmark"}),t._v(" Đóng ")])]},proxy:!0}])},[a("table",{staticClass:"table"},[a("tbody",[a("tr",[a("td",[a("strong",[t._v("Tên công ty:")])]),a("td",[t._v(t._s(t.contract.company_name))])]),a("tr",[a("td",[a("strong",[t._v("Mã số thuế:")])]),a("td",[t._v(t._s(t.contract.company_taxcode))])]),a("tr",[a("td",[a("strong",[t._v("Số HĐ:")])]),a("td",[t._v(t._s(t.contract.contract_number)+"/"+t._s(t.contract.contract_number_pattern))])]),a("tr",[a("td",[a("strong",[t._v("Ngày HĐ:")])]),a("td",[t._v(t._s(t._f("moment")(t.contract.contract_date,"DD/MM/YYYY")))])]),a("tr",[a("td",[a("strong",[t._v("Loại HĐ:")])]),a("td",[t._v(" "+t._s(t.contractType(t.contract.contract_type))+" ")])]),a("tr",[a("td",[a("strong",[t._v("Trạng thái HĐ:")])]),a("td",[a("span",{class:"badge text-bg-"+t.contract_status_class},[t._v(t._s(t.contractStatus(t.contract.contract_status)))])])]),a("tr",[a("td",[a("strong",[t._v("Thanh toán:")])]),a("td",[a("span",{class:"badge text-bg-"+t.contract_payment_class},[t._v(" "+t._s(t.contractPayment(t.contract.contract_payment)))])])]),a("tr",[a("td",[a("strong",[t._v("Mã LĐ/TT:")])]),a("td",[t._v(t._s(t.contract.contract_code))])])])]),a("table",{staticClass:"table table-striped"},[a("thead",{staticClass:"table-dark"},[a("tr",[a("th",{staticClass:"rounded-start",attrs:{scope:"col"}},[t._v("#")]),a("th",[t._v("Nội dung")]),a("th",[t._v("ĐVT")]),a("th",[t._v("SL")]),a("th",[t._v("Đơn giá")]),a("th",[t._v("TT")]),a("th",{staticClass:"rounded-end",attrs:{scope:"col"}},[t._v("Mã TB")])])]),a("tbody",t._l(t.contract.details,(function(e,s){return a("tr",{key:e.detail_id},[a("td",[t._v(t._s(s+1))]),a("td",[t._v(t._s(e.detail_content))]),a("td",[t._v(t._s(e.detail_unit))]),a("td",[t._v(t._s(e.detail_quantity))]),a("td",[t._v(t._s(t._f("formatamout")(e.detail_product_price,0)))]),a("td",[t._v(" "+t._s(t._f("formatamout")(e.detail_quantity*e.detail_product_price,0))+" ")]),a("td",[t._v(t._s(e.ma_tb))])])})),0)])])},d=[],u=e(9773),h=e.n(u),p={data(){return{title:"Chi tiết hợp đồng",contract:[],contract_status_class:0,contract_payment_class:0}},methods:{show(t){this.contract=t,this.$bvModal.show("modal-contract-detail")},close(){this.$bvModal.hide("modal-contract-detail")},contractStatus(t){return this.contract_status_class=3==t||4==t?"success":"warning",this.$econtract.contractStatus(t)},contractPayment(t){return this.contract_payment_class=3==t?"success":"danger",this.$econtract.paymentStatus(t)},contractType(t){return 1==t?"Gia hạn":"Đăng ký mới"}}},m=p,_=e(1001),f=(0,_.Z)(m,l,d,!1,null,null,null),v=f.exports,y={components:{completeContract:i.Z,contractDetail:v},data(){return{}},props:{contracts:Array},methods:{showDetail(t){this.$refs.modalContractDetail.show(t)},unitPrice(t){let a=parseFloat(t.detail_product_price).toFixed(4),e=parseInt(t.detail_quantity);return t.detail_product_price>0?this.formatAmout(a*e,4):t.product.product_name},updateCompleteContract(t){let a=this.contracts.filter((a=>a.contract_id==t.contract_id))[0];a.contract_status=t.contract_status,a.contract_payment=t.contract_payment},completeContract(t,a){this.$refs.completeContract.show(t,a)},cancelContract(t,a){this.$emit("cancelContract",t,a)},formatAmout(t,a){return this.$econtract.formatAmout(t,a)},getType(t){return 0==t?"Gia hạn":"Mới"},contractStatus(t){return this.$econtract.contractStatus(t)},paymentStatus(t){return this.$econtract.paymentStatus(t)},downloads(t,a,e){try{let s=e;this.$econtract.showLoading();let n=a.temp_id;axios.post(`${API_URL}/exportcontract`,{contract_id:t,temp_id:n},{responseType:"blob"}).then((t=>{null==s&&(s="Nguoi_Mua_Khong_Co_MST");let e=`${s}-${a.temp_display}.docx`;const n=window.URL.createObjectURL(new Blob([t.data])),c=document.createElement("a");c.href=n,c.setAttribute("download",e),document.body.appendChild(c),c.click(),this.$econtract.hideLoading()}))}catch(s){this.$toast.danger(s.message),this.$econtract.hideLoading()}}}},g=y,C=(0,_.Z)(g,r,o,!1,null,"1b082738",null),b=C.exports,k=e(2847),x=e(1859),w=e(8915),B=e.n(w),M=e(1427),T={components:{pagination:c.Z,tableContracts:b,notFound:k.Z,datePicker:B()},data(){return{contractResponse:[],keyword:"",flagSearch:!1,searchBy:{taxcode:!1,company_name:!1,placeholder:"Tìm theo tên công ty",startDate:h()().startOf("month").format("DD/MM/YYYY"),endDate:h()().add(0,"months").endOf("month").format("DD/MM/YYYY"),payment_status:0,contract_status:-1,page:1,contract_code:""},offset:4,dataLogin:[],options:{format:"DD/MM/YYYY",useCurrent:!1},debounceTimeout:null}},watch:{"searchBy.company_name":{handler(t){t&&(this.searchBy.placeholder="Tìm theo tên công ty")},immediate:!0},"searchBy.taxcode":{handler(t){t&&(this.searchBy.placeholder="Tìm theo mã số thuế công ty")},immediate:!0}},computed:{...(0,M.Se)("contracts",["contracts","pagination"])},created(){this.$route.query.query?(this.keyword=this.$route.query.query,this.fetchAll({page:1,name:this.keyword})):this.fetchAll(this.searchBy)},methods:{...(0,M.nv)("contracts",["getContracts"]),advanceSearch(){this.fetchAll({date:{startDate:this.searchBy.startDate,endDate:this.searchBy.endDate},page:this.pagination.current_page,payment:this.searchBy.payment_status,status:this.searchBy.contract_status,code:this.searchBy.contract_code})},search(){const t=this.keyword?{query:this.keyword}:null;this.$route.query.query!==this.keyword&&this.$router.push({query:t}).catch((t=>{if("NavigationDuplicated"!==t.name)throw t})),this.fetchAll({page:this.pagination.current_page,name:this.keyword})},cancelContract(t,a){this.$confirm({title:"Hủy hợp động",message:"Bạn có muốn hủy hợp đồng?",button:{yes:"Yes",no:"No"},callback:e=>{e&&x.Z.delete(`/contracts/${t.contract_id}`).then((t=>{200==t.status&&(this.contracts.splice(a,1),this.$toast.success("Hủy hợp đồng thành công"))}))}})},formattedDate(t){return t},async fetchAll(t){this.$econtract.showLoading(),clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout((()=>{this.getContracts(t).then((()=>{this.$econtract.hideLoading()}))}),300)}}},$=T,D=(0,_.Z)($,s,n,!1,null,null,null),Y=D.exports}}]);
//# sourceMappingURL=114.f2627fa3.js.map